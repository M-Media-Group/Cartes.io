{"version":3,"sources":["webpack://site/./resources/js/components/MapContainerComponent.vue?47f1","webpack://site/resources/js/components/MapContainerComponent.vue","webpack://site/./resources/js/components/MapContainerComponent.vue?d16a","webpack://site/./resources/js/components/MapContainerComponent.vue?7544","webpack://site/./resources/js/components/MapContainerComponent.vue","webpack://site/./resources/js/components/MapContainerComponent.vue?587e"],"names":["___CSS_LOADER_EXPORT___","push","module","id","options","_vm","this","_h","$createElement","_c","_self","staticStyle","attrs","map","uuid","map_token","users_can_create_markers","categories","activeMarkers","user","on","handleMarkerCreate","handleMarkerDelete","staticClass","_v","handleMapUpdate","_e","map_settings","show_all","mapSelectedAge","_s","directives","name","rawName","value","expression","mapAgeInMinutes","domProps","$event","$set","target","Array","isArray","_i","$$a","$$el","$$c","checked","$$i","concat","slice","nonSpamMarkers","length","expiredMarkers","markers"],"mappings":"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","file":"js/798.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#formControlRange{direction:rtl}\", \"\",{\"version\":3,\"sources\":[\"webpack://./resources/js/components/MapContainerComponent.vue\"],\"names\":[],\"mappings\":\"AA0QA,kBACA,aACA\",\"sourcesContent\":[\"<template>\\n    <div>\\n        <map-component v-if=\\\"map\\\" :map_id=\\\"map.uuid\\\" :map_token=\\\"map_token\\\" style=\\\"height: 65vh;\\\" :users_can_create_markers=\\\"map.users_can_create_markers\\\" :map_categories=\\\"categories\\\" :initial_markers=\\\"activeMarkers\\\" v-on:marker-create=\\\"handleMarkerCreate\\\" v-on:marker-delete=\\\"handleMarkerDelete\\\" :user=\\\"user\\\"></map-component>\\n        <div v-else style=\\\"height: 65vh;\\\" class=\\\"row align-items-center bg-dark\\\">\\n            <div class=\\\"col text-center\\\">\\n                <div>Cartes.io</div>\\n                <p class=\\\"text-muted mb-0\\\">Contacting planet Earth...</p>\\n            </div>\\n        </div>\\n        <div class=\\\"container\\\">\\n            <div class=\\\"row justify-content-center mt-5\\\">\\n                <div class=\\\"col-md-12\\\" style=\\\"max-width: 950px;\\\">\\n                    <map-details-component :map_id=\\\"map.uuid\\\" :map_token=\\\"map_token\\\" :map=\\\"map\\\" v-on:map-update=\\\"handleMapUpdate\\\">\\n                        <map-markers-feed-component v-if=\\\"hasLiveData\\\" :markers=\\\"activeMarkers\\\"></map-markers-feed-component>\\n                        <div class=\\\"card bg-dark text-white mb-3\\\">\\n                            <div class=\\\"card-header\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#displayCollapse\\\" aria-expanded=\\\"false\\\" aria-controls=\\\"displayCollapse\\\" style=\\\"cursor: pointer;\\\"><i class=\\\"fa fa-sliders\\\"></i> Map display options</div>\\n                            <div class=\\\"card-body collapse\\\" id=\\\"displayCollapse\\\">\\n                                <div class=\\\"form-group row\\\" v-if=\\\"!map_settings.show_all\\\">\\n                                    <label class=\\\"col-md-12 col-form-label\\\" for=\\\"formControlRange\\\">Time slider\\n                                        <small v-if=\\\"map_settings.mapSelectedAge > 0\\\">(showing map as of {{map_settings.mapSelectedAge}} minutes ago)</small>\\n                                        <small v-else>(showing live map)</small>\\n                                    </label>\\n                                    <div class=\\\"col-md-12\\\">\\n                                        <input type=\\\"range\\\" class=\\\"form-control-range w-100\\\" id=\\\"formControlRange\\\" :max=\\\"mapAgeInMinutes\\\" step=\\\"5\\\" min=\\\"0\\\" v-model=\\\"map_settings.mapSelectedAge\\\">\\n                                    </div>\\n                                </div>\\n                                <div class=\\\"form-group row\\\">\\n                                    <label class=\\\"col-md-12 col-form-label\\\">Visible markers</label>\\n                                    <div class=\\\"col-md-12\\\">\\n                                        <div class=\\\"form-check\\\">\\n                                            <input type=\\\"checkbox\\\" id=\\\"show_all_checkbox\\\" v-model=\\\"map_settings.show_all\\\">\\n                                            <label class=\\\"form-check-label\\\" for=\\\"show_all_checkbox\\\">\\n                                                Show all markers\\n                                            </label>\\n                                        </div>\\n                                    </div>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        <!--                         <api-data-transformer-component v-on:markers-updated=\\\"handleApiMarkers\\\"></api-data-transformer-component>\\n -->\\n                    </map-details-component>\\n                    <h2 class=\\\"mt-5\\\" v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\">Map stats</h2>\\n                    <div class=\\\"row\\\" v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\">\\n                        <div class=\\\"col-md-6\\\">\\n                            <h3>Total markers</h3>\\n                            <div class=\\\"jumbotron jumbotron-fluid bg-dark rounded\\\">\\n                                <div class=\\\"container\\\">\\n                                    <div class=\\\"display-4 text-center\\\">{{nonSpamMarkers.length}}</div>\\n                                    <p class=\\\"lead text-center\\\">All the markers created.</p>\\n                                </div>\\n                            </div>\\n                        </div>\\n                        <div class=\\\"col-md-6\\\">\\n                            <h3>Active markers</h3>\\n                            <div class=\\\"jumbotron jumbotron-fluid bg-dark rounded\\\">\\n                                <div class=\\\"container\\\">\\n                                    <div class=\\\"display-4 text-center\\\">{{nonSpamMarkers.length - expiredMarkers.length}}</div>\\n                                    <p class=\\\"lead text-center\\\">Markers that are currently live.</p>\\n                                </div>\\n                            </div>\\n                        </div>\\n                    </div>\\n                    <map-markers-chart-component v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\" :markers=\\\"markers\\\"></map-markers-chart-component>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n</template>\\n<script>\\nexport default {\\n    // props: ['initial_map', 'initial_markers', 'initial_map_token', 'user'],\\n\\n    props: {\\n        // Basic type check (`null` and `undefined` values will pass any type validation)\\n        initial_map: Object,\\n        // Multiple possible types\\n        initial_markers: Object,\\n        // Required string\\n        initial_map_token: {\\n          type: String,\\n          required: false\\n        },\\n        // Object with a default value\\n        user: {\\n          type: Object,\\n          // Object or array defaults must be returned from\\n          // a factory function\\n          default: function () {\\n            return { }\\n          }\\n        }\\n      },\\n\\n    components: {},\\n\\n    data() {\\n        return {\\n            map: this.initial_map,\\n            map_token: this.initial_map_token,\\n            markers: this.initial_markers,\\n            map_settings: {\\n                show_all: false,\\n                mapSelectedAge: 0,\\n            },\\n        }\\n    },\\n\\n    created() {\\n        if (!this.markers) {\\n            this.getAllMarkers()\\n        }\\n        this.listenForNewMarkers()\\n        this.listenForDeletedMarkers()\\n    },\\n\\n    mounted() {\\n\\n    },\\n\\n    computed: {\\n        mapAgeInMinutes() {\\n            if (!this.map) {\\n                return false;\\n            }\\n            return Math.abs(Vue.moment().diff(this.map.created_at, 'minutes'))\\n        },\\n        nonSpamMarkers() {\\n            if (!this.markers) {\\n                return []\\n            }\\n            return this.markers.filter(function(marker) {\\n                if(marker.is_spam && !localStorage['post_' + marker.id]){\\n                    return false\\n                }\\n                return true\\n            })\\n        },\\n        activeMarkers() {\\n            if (!this.markers) {\\n                return []\\n            } else if (this.map_settings.show_all) {\\n                return this.nonSpamMarkers\\n            }\\n\\n            let diff_date_time = Vue.moment().subtract(this.map_settings.mapSelectedAge, 'minutes');\\n\\n            return this.nonSpamMarkers.filter(function(marker) {\\n\\n                if (Vue.moment(marker.created_at).isSameOrBefore(diff_date_time, 'minute') && (marker.expires_at == null || Vue.moment(diff_date_time).isBefore(marker.expires_at))) {\\n                    return true\\n                }\\n                return false\\n            })\\n        },\\n        expiredMarkers() {\\n            if (!this.nonSpamMarkers) {\\n                return []\\n            }\\n            return this.nonSpamMarkers.filter(function(marker) {\\n                if (!marker.expires_at) {\\n                    return false\\n                }\\n                return Vue.moment().isAfter(Vue.moment(marker.expires_at))\\n                //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\\n            })\\n        },\\n        hasLiveData() {\\n            if (!this.map) {\\n                return false\\n            }\\n            if (this.map.users_can_create_markers === 'no') {\\n                return false\\n            }\\n            if (this.markers < 1) {\\n                return false\\n            }\\n            return true\\n        },\\n        categories() {\\n            if (!this.markers) {\\n                return []\\n            }\\n            var map1 = this.markers.map(x => x.category);\\n            return map1.map(e => e.id)\\n                // store the indexes of the unique objects\\n                .map((e, i, final) => final.indexOf(e) === i && i)\\n                // eliminate the false indexes & return unique objects\\n                .filter((e) => map1[e]).map(e => map1[e]);\\n        }\\n    },\\n\\n    watch: {\\n\\n    },\\n\\n    methods: {\\n        groupBy(list, keyGetter) {\\n            const map = new Map();\\n            list.forEach((item) => {\\n                const key = keyGetter(item);\\n                const collection = map.get(key);\\n                if (!collection) {\\n                    map.set(key, [item]);\\n                } else {\\n                    collection.push(item);\\n                }\\n            });\\n            return map;\\n        },\\n\\n        getAllMarkers() {\\n            axios\\n                .get('/api/maps/' + this.map.uuid + '/markers?show_expired=true')\\n                .then(response => (\\n                    this.markers = response.data\\n                ))\\n        },\\n\\n        listenForNewMarkers() {\\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerCreated', (e) => {\\n                // this.$notify(\\\"A new marker was just added\\\")\\n                this.$notify({\\n                        type: 'success',\\n                        title: '\\\"'+e.marker.category.name+'\\\" marker was just added',\\n                        text: e.marker.description\\n                      })\\n                this.handleMarkerCreate(e.marker);\\n            });\\n        },\\n\\n        listenForDeletedMarkers() {\\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerDeleted', (e) => {\\n                this.handleMarkerDelete(e.marker.id);\\n            });\\n        },\\n\\n        handleMarkerCreate(marker) {\\n            this.markers.push(marker);\\n        },\\n\\n        handleMarkerDelete(id) {\\n            this.$notify(\\\"A marker was just deleted\\\");\\n            this.markers = this.markers.filter((e) => e.id !== id);\\n        },\\n\\n        handleMapUpdate(map) {\\n            this.$notify(\\\"Information about this map has been updated\\\")\\n            this.map = map\\n        },\\n\\n        handleApiMarkers(markers) {\\n            this.markers = markers\\n        },\\n        markerInLocalStorageKey(id) {\\n            if (localStorage['post_' + id]) {\\n                return true\\n            }\\n            return false\\n        }\\n\\n    }\\n}\\n\\n</script>\\n<style>\\n#formControlRange {\\n    direction: rtl\\n}\\n\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<template>\n    <div>\n        <map-component v-if=\"map\" :map_id=\"map.uuid\" :map_token=\"map_token\" style=\"height: 65vh;\" :users_can_create_markers=\"map.users_can_create_markers\" :map_categories=\"categories\" :initial_markers=\"activeMarkers\" v-on:marker-create=\"handleMarkerCreate\" v-on:marker-delete=\"handleMarkerDelete\" :user=\"user\"></map-component>\n        <div v-else style=\"height: 65vh;\" class=\"row align-items-center bg-dark\">\n            <div class=\"col text-center\">\n                <div>Cartes.io</div>\n                <p class=\"text-muted mb-0\">Contacting planet Earth...</p>\n            </div>\n        </div>\n        <div class=\"container\">\n            <div class=\"row justify-content-center mt-5\">\n                <div class=\"col-md-12\" style=\"max-width: 950px;\">\n                    <map-details-component :map_id=\"map.uuid\" :map_token=\"map_token\" :map=\"map\" v-on:map-update=\"handleMapUpdate\">\n                        <map-markers-feed-component v-if=\"hasLiveData\" :markers=\"activeMarkers\"></map-markers-feed-component>\n                        <div class=\"card bg-dark text-white mb-3\">\n                            <div class=\"card-header\" data-toggle=\"collapse\" data-target=\"#displayCollapse\" aria-expanded=\"false\" aria-controls=\"displayCollapse\" style=\"cursor: pointer;\"><i class=\"fa fa-sliders\"></i> Map display options</div>\n                            <div class=\"card-body collapse\" id=\"displayCollapse\">\n                                <div class=\"form-group row\" v-if=\"!map_settings.show_all\">\n                                    <label class=\"col-md-12 col-form-label\" for=\"formControlRange\">Time slider\n                                        <small v-if=\"map_settings.mapSelectedAge > 0\">(showing map as of {{map_settings.mapSelectedAge}} minutes ago)</small>\n                                        <small v-else>(showing live map)</small>\n                                    </label>\n                                    <div class=\"col-md-12\">\n                                        <input type=\"range\" class=\"form-control-range w-100\" id=\"formControlRange\" :max=\"mapAgeInMinutes\" step=\"5\" min=\"0\" v-model=\"map_settings.mapSelectedAge\">\n                                    </div>\n                                </div>\n                                <div class=\"form-group row\">\n                                    <label class=\"col-md-12 col-form-label\">Visible markers</label>\n                                    <div class=\"col-md-12\">\n                                        <div class=\"form-check\">\n                                            <input type=\"checkbox\" id=\"show_all_checkbox\" v-model=\"map_settings.show_all\">\n                                            <label class=\"form-check-label\" for=\"show_all_checkbox\">\n                                                Show all markers\n                                            </label>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        <!--                         <api-data-transformer-component v-on:markers-updated=\"handleApiMarkers\"></api-data-transformer-component>\n -->\n                    </map-details-component>\n                    <h2 class=\"mt-5\" v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\">Map stats</h2>\n                    <div class=\"row\" v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\">\n                        <div class=\"col-md-6\">\n                            <h3>Total markers</h3>\n                            <div class=\"jumbotron jumbotron-fluid bg-dark rounded\">\n                                <div class=\"container\">\n                                    <div class=\"display-4 text-center\">{{nonSpamMarkers.length}}</div>\n                                    <p class=\"lead text-center\">All the markers created.</p>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <h3>Active markers</h3>\n                            <div class=\"jumbotron jumbotron-fluid bg-dark rounded\">\n                                <div class=\"container\">\n                                    <div class=\"display-4 text-center\">{{nonSpamMarkers.length - expiredMarkers.length}}</div>\n                                    <p class=\"lead text-center\">Markers that are currently live.</p>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <map-markers-chart-component v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\" :markers=\"markers\"></map-markers-chart-component>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\nexport default {\n    // props: ['initial_map', 'initial_markers', 'initial_map_token', 'user'],\n\n    props: {\n        // Basic type check (`null` and `undefined` values will pass any type validation)\n        initial_map: Object,\n        // Multiple possible types\n        initial_markers: Object,\n        // Required string\n        initial_map_token: {\n          type: String,\n          required: false\n        },\n        // Object with a default value\n        user: {\n          type: Object,\n          // Object or array defaults must be returned from\n          // a factory function\n          default: function () {\n            return { }\n          }\n        }\n      },\n\n    components: {},\n\n    data() {\n        return {\n            map: this.initial_map,\n            map_token: this.initial_map_token,\n            markers: this.initial_markers,\n            map_settings: {\n                show_all: false,\n                mapSelectedAge: 0,\n            },\n        }\n    },\n\n    created() {\n        if (!this.markers) {\n            this.getAllMarkers()\n        }\n        this.listenForNewMarkers()\n        this.listenForDeletedMarkers()\n    },\n\n    mounted() {\n\n    },\n\n    computed: {\n        mapAgeInMinutes() {\n            if (!this.map) {\n                return false;\n            }\n            return Math.abs(Vue.moment().diff(this.map.created_at, 'minutes'))\n        },\n        nonSpamMarkers() {\n            if (!this.markers) {\n                return []\n            }\n            return this.markers.filter(function(marker) {\n                if(marker.is_spam && !localStorage['post_' + marker.id]){\n                    return false\n                }\n                return true\n            })\n        },\n        activeMarkers() {\n            if (!this.markers) {\n                return []\n            } else if (this.map_settings.show_all) {\n                return this.nonSpamMarkers\n            }\n\n            let diff_date_time = Vue.moment().subtract(this.map_settings.mapSelectedAge, 'minutes');\n\n            return this.nonSpamMarkers.filter(function(marker) {\n\n                if (Vue.moment(marker.created_at).isSameOrBefore(diff_date_time, 'minute') && (marker.expires_at == null || Vue.moment(diff_date_time).isBefore(marker.expires_at))) {\n                    return true\n                }\n                return false\n            })\n        },\n        expiredMarkers() {\n            if (!this.nonSpamMarkers) {\n                return []\n            }\n            return this.nonSpamMarkers.filter(function(marker) {\n                if (!marker.expires_at) {\n                    return false\n                }\n                return Vue.moment().isAfter(Vue.moment(marker.expires_at))\n                //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\n            })\n        },\n        hasLiveData() {\n            if (!this.map) {\n                return false\n            }\n            if (this.map.users_can_create_markers === 'no') {\n                return false\n            }\n            if (this.markers < 1) {\n                return false\n            }\n            return true\n        },\n        categories() {\n            if (!this.markers) {\n                return []\n            }\n            var map1 = this.markers.map(x => x.category);\n            return map1.map(e => e.id)\n                // store the indexes of the unique objects\n                .map((e, i, final) => final.indexOf(e) === i && i)\n                // eliminate the false indexes & return unique objects\n                .filter((e) => map1[e]).map(e => map1[e]);\n        }\n    },\n\n    watch: {\n\n    },\n\n    methods: {\n        groupBy(list, keyGetter) {\n            const map = new Map();\n            list.forEach((item) => {\n                const key = keyGetter(item);\n                const collection = map.get(key);\n                if (!collection) {\n                    map.set(key, [item]);\n                } else {\n                    collection.push(item);\n                }\n            });\n            return map;\n        },\n\n        getAllMarkers() {\n            axios\n                .get('/api/maps/' + this.map.uuid + '/markers?show_expired=true')\n                .then(response => (\n                    this.markers = response.data\n                ))\n        },\n\n        listenForNewMarkers() {\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerCreated', (e) => {\n                // this.$notify(\"A new marker was just added\")\n                this.$notify({\n                        type: 'success',\n                        title: '\"'+e.marker.category.name+'\" marker was just added',\n                        text: e.marker.description\n                      })\n                this.handleMarkerCreate(e.marker);\n            });\n        },\n\n        listenForDeletedMarkers() {\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerDeleted', (e) => {\n                this.handleMarkerDelete(e.marker.id);\n            });\n        },\n\n        handleMarkerCreate(marker) {\n            this.markers.push(marker);\n        },\n\n        handleMarkerDelete(id) {\n            this.$notify(\"A marker was just deleted\");\n            this.markers = this.markers.filter((e) => e.id !== id);\n        },\n\n        handleMapUpdate(map) {\n            this.$notify(\"Information about this map has been updated\")\n            this.map = map\n        },\n\n        handleApiMarkers(markers) {\n            this.markers = markers\n        },\n        markerInLocalStorageKey(id) {\n            if (localStorage['post_' + id]) {\n                return true\n            }\n            return false\n        }\n\n    }\n}\n\n</script>\n<style>\n#formControlRange {\n    direction: rtl\n}\n\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=script&lang=js&\"","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[1]!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[2]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=style&index=0&lang=css&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { render, staticRenderFns } from \"./MapContainerComponent.vue?vue&type=template&id=2a0e7571&\"\nimport script from \"./MapContainerComponent.vue?vue&type=script&lang=js&\"\nexport * from \"./MapContainerComponent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MapContainerComponent.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.map)?_c('map-component',{staticStyle:{\"height\":\"65vh\"},attrs:{\"map_id\":_vm.map.uuid,\"map_token\":_vm.map_token,\"users_can_create_markers\":_vm.map.users_can_create_markers,\"map_categories\":_vm.categories,\"initial_markers\":_vm.activeMarkers,\"user\":_vm.user},on:{\"marker-create\":_vm.handleMarkerCreate,\"marker-delete\":_vm.handleMarkerDelete}}):_c('div',{staticClass:\"row align-items-center bg-dark\",staticStyle:{\"height\":\"65vh\"}},[_c('div',{staticClass:\"col text-center\"},[_c('div',[_vm._v(\"Cartes.io\")]),_vm._v(\" \"),_c('p',{staticClass:\"text-muted mb-0\"},[_vm._v(\"Contacting planet Earth...\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"row justify-content-center mt-5\"},[_c('div',{staticClass:\"col-md-12\",staticStyle:{\"max-width\":\"950px\"}},[_c('map-details-component',{attrs:{\"map_id\":_vm.map.uuid,\"map_token\":_vm.map_token,\"map\":_vm.map},on:{\"map-update\":_vm.handleMapUpdate}},[(_vm.hasLiveData)?_c('map-markers-feed-component',{attrs:{\"markers\":_vm.activeMarkers}}):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"card bg-dark text-white mb-3\"},[_c('div',{staticClass:\"card-header\",staticStyle:{\"cursor\":\"pointer\"},attrs:{\"data-toggle\":\"collapse\",\"data-target\":\"#displayCollapse\",\"aria-expanded\":\"false\",\"aria-controls\":\"displayCollapse\"}},[_c('i',{staticClass:\"fa fa-sliders\"}),_vm._v(\" Map display options\")]),_vm._v(\" \"),_c('div',{staticClass:\"card-body collapse\",attrs:{\"id\":\"displayCollapse\"}},[(!_vm.map_settings.show_all)?_c('div',{staticClass:\"form-group row\"},[_c('label',{staticClass:\"col-md-12 col-form-label\",attrs:{\"for\":\"formControlRange\"}},[_vm._v(\"Time slider\\n                                       \"),(_vm.map_settings.mapSelectedAge > 0)?_c('small',[_vm._v(\"(showing map as of \"+_vm._s(_vm.map_settings.mapSelectedAge)+\" minutes ago)\")]):_c('small',[_vm._v(\"(showing live map)\")])]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-12\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.map_settings.mapSelectedAge),expression:\"map_settings.mapSelectedAge\"}],staticClass:\"form-control-range w-100\",attrs:{\"type\":\"range\",\"id\":\"formControlRange\",\"max\":_vm.mapAgeInMinutes,\"step\":\"5\",\"min\":\"0\"},domProps:{\"value\":(_vm.map_settings.mapSelectedAge)},on:{\"__r\":function($event){return _vm.$set(_vm.map_settings, \"mapSelectedAge\", $event.target.value)}}})])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"form-group row\"},[_c('label',{staticClass:\"col-md-12 col-form-label\"},[_vm._v(\"Visible markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-12\"},[_c('div',{staticClass:\"form-check\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.map_settings.show_all),expression:\"map_settings.show_all\"}],attrs:{\"type\":\"checkbox\",\"id\":\"show_all_checkbox\"},domProps:{\"checked\":Array.isArray(_vm.map_settings.show_all)?_vm._i(_vm.map_settings.show_all,null)>-1:(_vm.map_settings.show_all)},on:{\"change\":function($event){var $$a=_vm.map_settings.show_all,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.map_settings, \"show_all\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.map_settings, \"show_all\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.map_settings, \"show_all\", $$c)}}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"show_all_checkbox\"}},[_vm._v(\"\\n                                               Show all markers\\n                                           \")])])])])])])],1),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('h2',{staticClass:\"mt-5\"},[_vm._v(\"Map stats\")]):_vm._e(),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-6\"},[_c('h3',[_vm._v(\"Total markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"jumbotron jumbotron-fluid bg-dark rounded\"},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"display-4 text-center\"},[_vm._v(_vm._s(_vm.nonSpamMarkers.length))]),_vm._v(\" \"),_c('p',{staticClass:\"lead text-center\"},[_vm._v(\"All the markers created.\")])])])]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-6\"},[_c('h3',[_vm._v(\"Active markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"jumbotron jumbotron-fluid bg-dark rounded\"},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"display-4 text-center\"},[_vm._v(_vm._s(_vm.nonSpamMarkers.length - _vm.expiredMarkers.length))]),_vm._v(\" \"),_c('p',{staticClass:\"lead text-center\"},[_vm._v(\"Markers that are currently live.\")])])])])]):_vm._e(),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('map-markers-chart-component',{attrs:{\"markers\":_vm.markers}}):_vm._e()],1)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}