(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+fAT":function(t,e,a){var s={"./components/ApiDataTransformerComponent.vue":"kt7l","./components/ExampleComponent.vue":"AEaB","./components/MapCardComponent.vue":"Sr5G","./components/MapComponent.vue":"rlHA","./components/MapContainerComponent.vue":"o0eb","./components/MapDetailsComponent.vue":"tq84","./components/MapMarkersChartComponent.vue":"vMva","./components/MapMarkersFeedComponent.vue":"oVQG","./components/MyMapsComponent.vue":"4lAs","./components/PublicMapContainerComponent.vue":"HP2v","./components/RevokeConsentComponent.vue":"dS//","./components/Rss.vue":"9oGP"};function r(t){var e=n(t);return a(e)}function n(t){if(!a.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}r.keys=function(){return Object.keys(s)},r.resolve=n,t.exports=r,r.id="+fAT"},"+wvE":function(t,e,a){"use strict";a.r(e);var s=a("H8ri"),r=s.c.reactiveProp;e.default={extends:s.a,mixins:[r],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}}},0:function(t,e,a){a("bUC5"),t.exports=a("pyCd")},"4lAs":function(t,e,a){"use strict";a.r(e);var s={data:function(){return{public_maps:[],private_maps:[],public_maps_total:0,private_maps_total:0}},created:function(){var t=this,e=[];Object.keys(localStorage).forEach((function(t){t.includes("map_")&&e.push(t.replace("map_",""))})),axios.get("/api/maps?orderBy=markers_count").then((function(e){t.public_maps_total=e.data.total,t.public_maps=e.data.data})),e.length>0&&axios.get("/api/maps",{params:{ids:e,orderBy:"updated_at"}}).then((function(e){t.private_maps_total=e.data.total,t.private_maps=e.data.data}))},computed:{},watch:{},methods:{}},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",[t._v("Your maps")]),t._v(" "),a("p",[t._v("These are the maps that you've created on the site.")]),t._v(" "),t._l(t.private_maps,(function(t,e){return a("map-card-component",{key:t.uuid,attrs:{map:t,disable_map:e>0}})})),t._v(" "),t.private_maps.length<1?a("div",{staticClass:"alert bg-dark"},[t._v("You have no maps yet. Create your first map or browse the public ones below.\n        "),a("button",{staticClass:"btn btn-primary w-100 mt-3",attrs:{type:"submit",form:"new_map_form"}},[t._v("\n            Create your first map\n        ")])]):t._e(),t._v(" "),t.private_maps_total>15?a("div",{staticClass:"row justify-content-center mb-5"},[a("div",{staticClass:"small"},[t._v(t._s(t.private_maps.length)+" / "+t._s(t.private_maps_total)+" of your maps are shown here")])]):t._e(),t._v(" "),a("hr",{staticClass:"my-4"}),t._v(" "),a("h2",{staticClass:"mt-5"},[t._v("Public maps")]),t._v(" "),a("p",[t._v("These maps are made by the community and shared with everyone.")]),t._v(" "),t._l(t.public_maps,(function(t,e){return a("map-card-component",{key:"p_map"+t.uuid,attrs:{map:t,disable_map:e>2}})})),t._v(" "),t.public_maps_total>15?a("div",{staticClass:"row justify-content-center mb-5"},[a("div",{staticClass:"small"},[t._v(t._s(t.public_maps.length)+" / "+t._s(t.public_maps_total)+" public maps, and a lot more private ones")])]):t._e()],2)}),[],!1,null,null,null);e.default=n.exports},"9Gxm":function(t,e,a){var s=a("H0KD");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,r);s.locals&&(t.exports=s.locals)},"9Wh1":function(t,e,a){"use strict";a.r(e);var s=a("Vjiq");window._=a("LvDl");try{window.Popper=a("8L3F").default,window.$=window.jQuery=a("EVdn"),a("SYky")}catch(t){}window.axios=a("vDqi"),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var r=document.head.querySelector('meta[name="csrf-token"]');r?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=r.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token"),window.Pusher=a("eC5B"),window.Echo=new s.a({broadcaster:"pusher",key:"14011b674484b7b9c2e8",cluster:"eu",encrypted:!0})},"9oGP":function(t,e,a){"use strict";a.r(e);var s={props:["title","date","source","link"]},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"small"},[a("p",[t.title?a("a",{attrs:{target:"_BLANK",href:t.link}},[t._v(t._s(t.title)+" ")]):t._e(),t._v(" "),t.date?a("small",[t._v(" "+t._s(t.date)+"\n            "),t.source?a("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.source)+" ")]):t._e()]):t._e()])])}),[],!1,null,null,null);e.default=n.exports},AEaB:function(t,e,a){"use strict";a.r(e);var s={mounted:function(){console.log("Component mounted.")}},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-8"},[e("div",{staticClass:"card card-default"},[e("div",{staticClass:"card-header"},[this._v("Example Component")]),this._v(" "),e("div",{staticClass:"card-body"},[this._v("\n                    I'm an example component.\n                ")])])])])])}],!1,null,null,null);e.default=n.exports},Dv8Q:function(t,e,a){"use strict";var s=a("9Gxm");a.n(s).a},H0KD:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,"\n#formControlRange {\n    direction: rtl\n}\n\n",""])},HP2v:function(t,e,a){"use strict";a.r(e);var s={props:[],components:{},data:function(){return{map_selector:"public",map:null,maps:[],user_maps:[],markers:null,menu_hidden:!1,map_settings:{show_all:!0,mapSelectedAge:0}}},created:function(){this.getAllMaps()},mounted:function(){this.getUsersMaps()},computed:{mapAgeInMinutes:function(){return!!this.map&&Math.abs(Vue.moment().diff(this.map.created_at,"minutes"))},activeMarkers:function(){if(!this.markers)return[];if(this.map_settings.show_all)return this.markers;var t=this.markers,e=Vue.moment().subtract(this.map_settings.mapSelectedAge,"minutes");return t.filter((function(t){return!(!Vue.moment(t.created_at).isSameOrBefore(e,"minute")||null!=t.expires_at&&!Vue.moment(e).isBefore(t.expires_at))}))},expiredMarkers:function(){return this.markers?this.markers.filter((function(t){return!!t.expires_at&&Vue.moment().isAfter(Vue.moment(t.expires_at))})):[]},hasLiveData:function(){return!!this.map&&("no"!==this.map.users_can_create_markers&&!(this.markers<1))},categories:function(){if(!this.markers)return[];var t=this.markers.map((function(t){return t.category}));return t.map((function(t){return t.id})).map((function(t,e,a){return a.indexOf(t)===e&&e})).filter((function(e){return t[e]})).map((function(e){return t[e]}))},activeMaps:function(){return"user"==this.map_selector?this.user_maps:this.maps.filter((function(t){return t.markers_count>0&&""!==t.title}))}},watch:{},methods:{groupBy:function(t,e){var a=new Map;return t.forEach((function(t){var s=e(t),r=a.get(s);r?r.push(t):a.set(s,[t])})),a},getAllMaps:function(){var t=this;axios.get("/api/maps").then((function(e){return t.maps=e.data.data,t.setMap(0)}))},getUsersMaps:function(){var t=this,e=[];Object.keys(localStorage).forEach((function(t){t.includes("map_")&&e.push(t.replace("map_",""))})),e.length>0&&axios.get("/api/maps",{params:{ids:e,orderBy:"updated_at"}}).then((function(e){t.user_maps=e.data.data}))},getAllMarkers:function(){var t=this;axios.get("/api/maps/"+this.map.uuid+"/markers?show_expired=true").then((function(e){return t.markers=e.data}))},listenForNewMarkers:function(){var t=this;Echo.channel("maps."+this.map.uuid).listen("MarkerCreated",(function(e){t.handleMarkerCreate(e.marker)}))},listenForDeletedMarkers:function(){var t=this;Echo.channel("maps."+this.map.uuid).listen("MarkerDeleted",(function(e){t.handleMarkerDelete(e.marker.id)}))},handleMarkerCreate:function(t){this.markers.push(t)},handleMarkerDelete:function(t){this.markers=this.markers.filter((function(e){return e.id!==t}))},handleMapUpdate:function(t){this.map=t},handleApiMarkers:function(t){this.markers=t},getMap:function(t){var e=this;axios.get("/api/maps/"+t).then((function(t){return e.map=t.data})),this.getAllMarkers(),this.listenForNewMarkers(),this.listenForDeletedMarkers()},setMap:function(t){this.map=this.activeMaps[t]},setMapSelector:function(t){this.map_selector=t},setMenuVisibility:function(t){return this.menu_hidden=!t}}},r=(a("XlJd"),a("KHd+")),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("transition",{attrs:{name:"slide"}},[t.menu_hidden?a("div",{key:"menu",staticStyle:{position:"fixed",left:"1.5rem",bottom:"3rem","z-index":"1000"}},[a("div",{staticClass:"btn btn-primary",on:{click:function(e){return t.setMenuVisibility(!0)}}},[t._v("Show all maps")]),t._v(" "),a("a",{staticClass:"btn btn-secondary",attrs:{href:/maps/+t.map.uuid}},[t._v("Open map page")])]):a("div",{key:"menu_button",staticClass:"p-0",staticStyle:{height:"100vh",position:"fixed",left:"0",top:"0","z-index":"1001","min-width":"18rem","max-width":"27rem","background-color":"var(--white)"}},[a("ul",{staticClass:"list-unstyled px-0 pb-3 bg-transparent card",attrs:{id:"marker_feed"}},[a("li",{staticClass:"media p-3 card-header",staticStyle:{cursor:"pointer",display:"block"}},[a("div",{staticClass:"media-body",staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("h5",{staticClass:"mt-0 mb-0"},[t._v("Maps on Cartes.io")]),t._v(" "),a("a",{staticClass:"btn btn-sm text-white",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.setMenuVisibility(0)}}},[t._v("X")])]),t._v(" "),a("div",{staticClass:"mt-3",staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[a("a",{staticClass:"btn btn-sm",class:["user"==t.map_selector?"btn-primary":"btn-dark"],attrs:{href:"#"},on:{click:function(e){return t.setMapSelector("user")}}},[t._v("Your maps")]),t._v(" "),a("a",{staticClass:"btn btn-sm",class:["public"==t.map_selector?"btn-primary":"btn-dark"],attrs:{href:"#"},on:{click:function(e){return t.setMapSelector("public")}}},[t._v("Public maps")])])]),t._v(" "),a("div",{staticClass:"collapse show",staticStyle:{"max-height":"83vh","overflow-y":"scroll"},attrs:{id:"marker_feed_markers"}},[t.activeMaps.length>0?[t._l(t.activeMaps,(function(e,s){return a("li",{key:"map_id_"+e.uuid,staticClass:"media ml-3 mr-3 p-3 mb-3 card",class:[t.map&&e.uuid==t.map.uuid?"bg-white text-dark":"bg-secondary text-white feed-element"],on:{click:function(e){return t.setMap(s)}}},[a("div",{staticClass:"media-body"},[a("h5",{staticClass:"mt-0 mb-1"},[t._v(t._s(e.title||"Untitled map"))]),t._v(" "),t.map&&e.uuid==t.map.uuid?a("div",[a("p",[t._v(t._s(e.description))]),t._v(" "),a("a",{staticClass:"btn btn-primary btn-block w-100",attrs:{href:/maps/+t.map.uuid}},[t._v("Open map page")])]):t._e()])])})),t._v(" "),a("li",{staticClass:"media ml-3 mr-3 p-3 mb-3"},[a("div",{staticClass:"media-body"},[a("button",{staticClass:"btn btn-primary mt-3 mb-5 w-100",attrs:{type:"submit",form:"new_map_form"}},[t._v("\n                                        Create a map\n                                    ")])])])]:[a("div",{staticClass:"text-center text-muted p-3"},[t._v("There's no maps to show.")]),t._v(" "),a("li",{staticClass:"media ml-3 mr-3 p-3 mb-3"},[a("div",{staticClass:"media-body"},[a("button",{staticClass:"btn btn-primary mt-3 mb-5 w-100",attrs:{type:"submit",form:"new_map_form"}},[t._v("\n                                        Create a map\n                                    ")])])])]],2)])])]),t._v(" "),a("div",{staticClass:"col-12 p-0",on:{touchstart:function(e){return t.setMenuVisibility(0)},mousedown:function(e){return t.setMenuVisibility(0)}}},[t.map?a("map-component",{staticStyle:{height:"100vh"},attrs:{map_id:t.map.uuid,map_token:null,users_can_create_markers:t.map.users_can_create_markers,map_categories:t.categories,initial_markers:null},on:{"marker-create":t.handleMarkerCreate,"marker-delete":t.handleMarkerDelete}}):a("div",{staticClass:"row align-items-center bg-dark",staticStyle:{height:"65vh"}},[a("div",{staticClass:"col text-center"},[a("div",[t._v("Cartes.io")]),t._v(" "),a("p",{staticClass:"text-muted mb-0"},[t._v("Contacting planet Earth...")])])])],1)],1)}),[],!1,null,null,null);e.default=n.exports},Icb6:function(t,e,a){"use strict";var s=a("X2tq");a.n(s).a},RnhZ:function(t,e,a){var s={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-in":"7C5Q","./en-in.js":"7C5Q","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./en-sg":"t+mt","./en-sg.js":"t+mt","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fil":"1ppg","./fil.js":"1ppg","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-deva":"qvJo","./gom-deva.js":"qvJo","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./oc-lnc":"Fnuy","./oc-lnc.js":"Fnuy","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-mo":"OmwH","./zh-mo.js":"OmwH","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function r(t){var e=n(t);return a(e)}function n(t){if(!a.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}r.keys=function(){return Object.keys(s)},r.resolve=n,t.exports=r,r.id="RnhZ"},Sr5G:function(t,e,a){"use strict";a.r(e);var s={props:["map","is_minimal","disable_map"],data:function(){return{}},mounted:function(){},computed:{},watch:{},methods:{}},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card bg-dark text-white mb-5",staticStyle:{"min-height":"250px"}},[t.disable_map?t._e():a("map-component",{staticStyle:{height:"50vh"},attrs:{map_id:t.map.uuid,map_categories:t.map.categories,users_can_create_markers:t.map.users_can_create_markers}}),t._v(" "),t.map.categories&&!t.disable_map?a("div",{staticClass:"pl-1 pr-1 d-flex",staticStyle:{top:"49vh","z-index":"1001",overflow:"scroll",width:"100%",position:"absolute"}},t._l(t.map.categories,(function(e){return a("a",{key:e.id,staticClass:"badge badge-secondary mr-1 mb-1",attrs:{href:"#"}},[t._v(t._s(e.name))])})),0):t._e(),t._v(" "),a("div",{staticClass:"card-body"},[a("h5",{staticClass:"card-title mt-3"},[t._v(t._s(t.map.title?t.map.title:"Untitled map"))]),t._v(" "),t.is_minimal?t._e():a("p",{staticClass:"card-text"},[t._v(t._s(t._f("truncate")(t.map.description,250,"...")))]),t._v(" "),a("a",{staticClass:"btn btn-primary btn-block",attrs:{href:/maps/+t.map.uuid}},[t._v("Open map")])]),t._v(" "),t.is_minimal?t._e():a("div",{staticClass:"card-footer"},[a("p",{staticClass:"card-text small text-secondary"},[t._v(t._s(t.map.markers_count)+" live markers Â· Updated "),a("span",{staticClass:"timestamp",attrs:{datetime:t.map.updated_at}},[t._v(t._s(t.map.updated_at))])])])],1)}),[],!1,null,null,null);e.default=n.exports},UtuO:function(t,e,a){"use strict";var s=a("iuh1");a.n(s).a},X2tq:function(t,e,a){var s=a("Yb9r");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,r);s.locals&&(t.exports=s.locals)},XlJd:function(t,e,a){"use strict";var s=a("xzCv");a.n(s).a},Yb9r:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,"\nli.feed-element {\n    cursor: pointer;\n    transition: 0.1s;\n}\nli.feed-element:hover {\n   background-color: var(--primary) !important;\n}\n.blink {\n    -webkit-animation: blinker 1.5s cubic-bezier(.5, 0, 1, 1) infinite;\n            animation: blinker 1.5s cubic-bezier(.5, 0, 1, 1) infinite;\n}\n@-webkit-keyframes blinker {\nfrom { opacity: 1; transform: scale(0);\n}\nto { opacity: 0; transform: scale(1);\n}\n}\n@keyframes blinker {\nfrom { opacity: 1; transform: scale(0);\n}\nto { opacity: 0; transform: scale(1);\n}\n}\n",""])},bUC5:function(t,e,a){"use strict";a.r(e);var s=a("4R65");a("9Wh1"),window.timeago=a("xyvv"),window.Vue=a("XuX8"),delete s.Icon.Default.prototype._getIconUrl,s.Icon.Default.mergeOptions({iconRetinaUrl:a("WE1v"),iconUrl:a("Y5fm"),shadowUrl:a("4rkx")});var r=a("+fAT");r.keys().map((function(t){return Vue.component(t.split("/").pop().split(".")[0],r(t).default)})),Vue.component("chart-line-component",a("+wvE").default),Vue.component("chart-pie-component",a("pbe3").default),Vue.filter("truncate",(function(t,e,a){return t?t.length>e?t.substring(0,e)+a:t:"No description available"})),Vue.use(a("Lq01"));new Vue({el:"#app"})},dAhr:function(t,e,a){(e=t.exports=a("I1BE")(!1)).i(a("hhfp"),""),e.i(a("bKdT"),""),e.i(a("FekW"),""),e.push([t.i,"@import url(https://unpkg.com/leaflet-geosearch@2.6.0/assets/css/leaflet.css);",""]),e.push([t.i,"@import url(https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css);",""]),e.push([t.i,"\n.map-notification {\n    position: fixed;\n    bottom: 1rem;\n    z-index: 1002;\n    left: 1rem;\n    right: 1rem;\n}\n.your_custom_class .multiselect__option--highlight,\n.your_custom_class .multiselect__option::after {\n    background: var(--primary);\n}\n\n",""])},"dS//":function(t,e,a){"use strict";a.r(e);var s={data:function(){return{}},mounted:function(){},computed:{hasCookie:function(){return document.cookie.match(/^(.*;)?\s*laravel_cookie_consent\s*=\s*[^;]+(.*)?$/)}},watch:{},methods:{revokeConsent:function(){document.cookie="laravel_cookie_consent=; expires=Thu, 01 Jan 2000 00:00:00 GMT; path=/; domain=.incidents",document.cookie="laravel_cookie_consent=; expires=Thu, 01 Jan 2000 00:00:00 GMT; path=/; domain=.cartes.io",window.location.href="/"}}},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this.hasCookie?e("input",{staticClass:"btn btn-danger mb-5 mt-3",attrs:{type:"button",value:"Revoke analytics cookie consent"},on:{click:this.revokeConsent}}):this._e()])}),[],!1,null,null,null);e.default=n.exports},eGTV:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,'\n*[contenteditable="true"]{\n    display: inline-block;\n}\n',""])},eLWi:function(t,e,a){(t.exports=a("I1BE")(!1)).push([t.i,"\n#formControlRange {\n    direction: rtl\n}\n.slide-enter-active,\n.slide-leave-active\n{\n    transition: transform 0.2s ease;\n}\n.slide-enter,\n.slide-leave-to {\n    transform: translateX(-100%);\n    transition: all 150ms ease-in 0s;\n}\n",""])},iuh1:function(t,e,a){var s=a("dAhr");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,r);s.locals&&(t.exports=s.locals)},kt7l:function(t,e,a){"use strict";a.r(e);function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],s=!0,r=!1,n=void 0;try{for(var i,o=t[Symbol.iterator]();!(s=(i=o.next()).done)&&(a.push(i.value),!e||a.length!==e);s=!0);}catch(t){r=!0,n=t}finally{try{s||null==o.return||o.return()}finally{if(r)throw n}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return r(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i={props:["map_id","map_token","map"],components:{},data:function(){return{endpoint:"https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/4.5_month.geojson",fetched_data:null,transform_parameters:{container:"features",location:{lng:"geometry.coordinates.1",lat:"geometry.coordinates.0"},category_name:"properties.title",id:"id",created_at:"properties.time",updated_at:"properties.updated"}}},mounted:function(){},computed:{first_data_point:function(){return this.transformed_data_post_container?this.transformed_data_post_container[0]:null},transformed_data_post_container:function(){if(!this.fetched_data||this.fetched_data.length<1)return null;var t=null;if(this.transform_parameters.container){if(!this.fetched_data||!this.fetched_data[this.transform_parameters.container])return null;t=this.fetched_data[this.transform_parameters.container]}else var t=this.fetched_data;return Array.isArray(t)?t.slice(0,1e3):t},transformed_data:function(){var t=this;if(!this.fetched_data||!this.transform_parameters.created_at||!this.transform_parameters.updated_at)return null;var e=this.transformed_data_post_container;return!e||e.length<1||!Array.isArray(e)?null:e.map((function(e){return{id:t.resolve(t.transform_parameters.id,e),location:{type:"Point",coordinates:[t.resolve(t.transform_parameters.location.lng,e),t.resolve(t.transform_parameters.location.lat,e)]},created_at:Vue.moment(t.resolve(t.transform_parameters.created_at,e)).format(),updated_at:Vue.moment(t.resolve(t.transform_parameters.updated_at,e)).format(),description:null,expires_at:null,category:{name:t.resolve(t.transform_parameters.category_name,e),icon:"/images/marker-01.svg"}}}))},is_valid:function(){return!(!this.transformed_data||!this.transformed_data[0])&&(!!this.transformed_data[0].location.coordinates[0]&&(!!this.transformed_data[0].location.coordinates[1]&&(!!this.transformed_data[0].id&&(!!this.transformed_data[0].category.name&&(!!this.transformed_data[0].created_at&&(!!this.transformed_data[0].updated_at&&(this.emitNewMarkers(),!0)))))))}},watch:{},created:function(){this.debouncedGetAnswer=_.debounce(this.submitForm,750)},methods:{resolve:function(t,e){if("object"!==n(e))throw"getProp: obj is not an object";if("string"!=typeof t)throw"getProp: prop is not a string";return(t=t.replace(/\[["'`](.*)["'`]\]/g,".$1")).split(".").reduce((function(t,e){return t?t[e]:void 0}),e||self)},getData:function(){var t=this;(this.endpoint.includes("incidents:7888")||this.endpoint.includes("cartes.io"))&&(this.transform_parameters={container:"",location:{lng:"location.coordinates.0",lat:"location.coordinates.1"},category_name:"category.name",id:"id",created_at:"created_at",updated_at:"created_at"}),axios.get(this.endpoint,{maxContentLength:20971520,timeout:1e4,maxRedirects:0,transformRequest:[function(t,e){return delete e.common["X-Requested-With"],delete e.common["X-CSRF-TOKEN"],delete e["X-Socket-Id"],t}]}).then((function(e){t.fetched_data=e.data})).catch((function(t){console.log(t)}))},emitNewMarkers:function(){this.$emit("markers-updated",this.transformed_data)},submitForm:function(t){var e=this;this.submit_data.loading=!0,axios.put("/api/maps/"+this.map_id,this.submit_data).then((function(t){e.submit_data.loading=!1,e.$emit("map-update",t.data)})).catch((function(t){if(e.submit_data.loading=!1,console.log(t),t.response.data.errors)var a=Object.entries(t.response.data.errors).map((function(t,e){var a=s(t,2),r=a[0],n=a[1];return"".concat(r,": ").concat(n[0]," | ")})).join("\n");else a=t.response.data.message;alert(a)}))}}},o=a("KHd+"),l=Object(o.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 mt-5 mt-md-0"},[a("div",{key:"map-settings",staticClass:"card bg-dark text-white mb-3"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body collapse",attrs:{id:"settingsImportCollapse"}},[a("div",{staticClass:"form"},[a("div",{staticClass:"form-group mx-sm-3 mb-2"},[a("label",{staticClass:"sr-only",attrs:{for:"inputPassword2"}},[t._v("API Endpoint")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.endpoint,expression:"endpoint"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"API Endpoint"},domProps:{value:t.endpoint},on:{input:function(e){e.target.composing||(t.endpoint=e.target.value)}}})]),t._v(" "),a("button",{staticClass:"btn btn-primary mb-2",attrs:{type:"url"},on:{click:function(e){return t.getData()}}},[t._v("Fetch JSON data")])]),t._v(" "),t.is_valid?a("div",{staticClass:"alert alert-success"},[t._v("All good")]):t._e(),t._v(" "),a("details",{staticClass:"mt-3 mb-3 "},[t._m(1),t._v(" "),a("div",[a("pre",{staticClass:"text-white small"},[a("code",[t._v(t._s(t.first_data_point))])])])]),t._v(" "),a("hr"),t._v(" "),a("details",{staticClass:"mt-3 mb-3 "},[t._m(2),t._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.container,expression:"transform_parameters.container"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Container"},domProps:{value:t.transform_parameters.container},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters,"container",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.id,expression:"transform_parameters.id"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Marker ID"},domProps:{value:t.transform_parameters.id},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters,"id",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.location.lat,expression:"transform_parameters.location.lat"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Location LAT"},domProps:{value:t.transform_parameters.location.lat},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters.location,"lat",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.location.lng,expression:"transform_parameters.location.lng"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Location LNG"},domProps:{value:t.transform_parameters.location.lng},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters.location,"lng",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.category_name,expression:"transform_parameters.category_name"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Category name"},domProps:{value:t.transform_parameters.category_name},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters,"category_name",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.created_at,expression:"transform_parameters.created_at"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Created at"},domProps:{value:t.transform_parameters.created_at},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters,"created_at",e.target.value)}}}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.transform_parameters.updated_at,expression:"transform_parameters.updated_at"}],staticClass:"form-control",attrs:{type:"text",id:"inputPassword2",placeholder:"Updated at"},domProps:{value:t.transform_parameters.updated_at},on:{input:function(e){e.target.composing||t.$set(t.transform_parameters,"updated_at",e.target.value)}}})])]),t._v(" "),a("hr"),t._v(" "),a("details",{staticClass:"mt-3 mb-3 "},[t._m(3),t._v(" "),a("div",[a("pre",{staticClass:"text-white small"},[t.transformed_data?a("code",[t._v(t._s(t.transformed_data[0]))]):t._e()])])])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"collapse","data-target":"#settingsImportCollapse","aria-expanded":"false","aria-controls":"settingsImportCollapse"}},[e("i",{staticClass:"fa fa-cog"}),this._v(" Data importer")])},function(){var t=this.$createElement,e=this._self._c||t;return e("summary",[e("dt",{staticClass:"d-inline"},[this._v("Incoming request")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("summary",[e("dt",{staticClass:"d-inline "},[this._v("Data transforming/mapping tools")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("summary",[e("dt",{staticClass:"d-inline "},[this._v("Transformed request")])])}],!1,null,null,null);e.default=l.exports},o0eb:function(t,e,a){"use strict";a.r(e);var s={props:{initial_map:Object,initial_markers:Object,initial_map_token:{type:String,required:!1},user:{type:Object,default:function(){return{}}}},components:{},data:function(){return{map:this.initial_map,map_token:this.initial_map_token,markers:this.initial_markers,map_settings:{show_all:!1,mapSelectedAge:0}}},created:function(){this.markers||this.getAllMarkers(),this.listenForNewMarkers(),this.listenForDeletedMarkers()},mounted:function(){},computed:{mapAgeInMinutes:function(){return!!this.map&&Math.abs(Vue.moment().diff(this.map.created_at,"minutes"))},activeMarkers:function(){if(!this.markers)return[];if(this.map_settings.show_all)return this.markers;var t=this.markers,e=Vue.moment().subtract(this.map_settings.mapSelectedAge,"minutes");return t.filter((function(t){return!(!Vue.moment(t.created_at).isSameOrBefore(e,"minute")||null!=t.expires_at&&!Vue.moment(e).isBefore(t.expires_at))}))},expiredMarkers:function(){return this.markers?this.markers.filter((function(t){return!!t.expires_at&&Vue.moment().isAfter(Vue.moment(t.expires_at))})):[]},hasLiveData:function(){return!!this.map&&("no"!==this.map.users_can_create_markers&&!(this.markers<1))},categories:function(){if(!this.markers)return[];var t=this.markers.map((function(t){return t.category}));return t.map((function(t){return t.id})).map((function(t,e,a){return a.indexOf(t)===e&&e})).filter((function(e){return t[e]})).map((function(e){return t[e]}))}},watch:{},methods:{groupBy:function(t,e){var a=new Map;return t.forEach((function(t){var s=e(t),r=a.get(s);r?r.push(t):a.set(s,[t])})),a},getAllMarkers:function(){var t=this;axios.get("/api/maps/"+this.map.uuid+"/markers?show_expired=true").then((function(e){return t.markers=e.data}))},listenForNewMarkers:function(){var t=this;Echo.channel("maps."+this.map.uuid).listen("MarkerCreated",(function(e){t.handleMarkerCreate(e.marker)}))},listenForDeletedMarkers:function(){var t=this;Echo.channel("maps."+this.map.uuid).listen("MarkerDeleted",(function(e){t.handleMarkerDelete(e.marker.id)}))},handleMarkerCreate:function(t){this.markers.push(t)},handleMarkerDelete:function(t){this.markers=this.markers.filter((function(e){return e.id!==t}))},handleMapUpdate:function(t){this.map=t},handleApiMarkers:function(t){this.markers=t}}},r=(a("Dv8Q"),a("KHd+")),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.map?a("map-component",{staticStyle:{height:"65vh"},attrs:{map_id:t.map.uuid,map_token:t.map_token,users_can_create_markers:t.map.users_can_create_markers,map_categories:t.categories,initial_markers:t.activeMarkers,user:t.user},on:{"marker-create":t.handleMarkerCreate,"marker-delete":t.handleMarkerDelete}}):a("div",{staticClass:"row align-items-center bg-dark",staticStyle:{height:"65vh"}},[a("div",{staticClass:"col text-center"},[a("div",[t._v("Cartes.io")]),t._v(" "),a("p",{staticClass:"text-muted mb-0"},[t._v("Contacting planet Earth...")])])]),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-content-center mt-5"},[a("div",{staticClass:"col-md-12",staticStyle:{"max-width":"950px"}},[a("map-details-component",{attrs:{map_id:t.map.uuid,map_token:t.map_token,map:t.map},on:{"map-update":t.handleMapUpdate}},[t.hasLiveData?a("map-markers-feed-component",{attrs:{markers:t.activeMarkers}}):t._e(),t._v(" "),a("div",{staticClass:"card bg-dark text-white mb-3"},[a("div",{staticClass:"card-header",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"collapse","data-target":"#displayCollapse","aria-expanded":"false","aria-controls":"displayCollapse"}},[a("i",{staticClass:"fa fa-sliders"}),t._v(" Map display options")]),t._v(" "),a("div",{staticClass:"card-body collapse",attrs:{id:"displayCollapse"}},[t.map_settings.show_all?t._e():a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label",attrs:{for:"formControlRange"}},[t._v("Time slider\n                                       "),t.map_settings.mapSelectedAge>0?a("small",[t._v("(showing map as of "+t._s(t.map_settings.mapSelectedAge)+" minutes ago)")]):a("small",[t._v("(showing live map)")])]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.map_settings.mapSelectedAge,expression:"map_settings.mapSelectedAge"}],staticClass:"form-control-range w-100",attrs:{type:"range",id:"formControlRange",max:t.mapAgeInMinutes,step:"5",min:"0"},domProps:{value:t.map_settings.mapSelectedAge},on:{__r:function(e){return t.$set(t.map_settings,"mapSelectedAge",e.target.value)}}})])]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label"},[t._v("Visible markers")]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.map_settings.show_all,expression:"map_settings.show_all"}],attrs:{type:"checkbox",id:"show_all_checkbox"},domProps:{checked:Array.isArray(t.map_settings.show_all)?t._i(t.map_settings.show_all,null)>-1:t.map_settings.show_all},on:{change:function(e){var a=t.map_settings.show_all,s=e.target,r=!!s.checked;if(Array.isArray(a)){var n=t._i(a,null);s.checked?n<0&&t.$set(t.map_settings,"show_all",a.concat([null])):n>-1&&t.$set(t.map_settings,"show_all",a.slice(0,n).concat(a.slice(n+1)))}else t.$set(t.map_settings,"show_all",r)}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"show_all_checkbox"}},[t._v("\n                                               Show all markers\n                                           ")])])])])])])],1),t._v(" "),t.markers&&t.markers.length>0?a("h2",{staticClass:"mt-5"},[t._v("Map stats")]):t._e(),t._v(" "),t.markers&&t.markers.length>0?a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("h3",[t._v("Total markers")]),t._v(" "),a("div",{staticClass:"jumbotron jumbotron-fluid bg-dark rounded"},[a("div",{staticClass:"container"},[a("div",{staticClass:"display-4 text-center"},[t._v(t._s(t.markers.length))]),t._v(" "),a("p",{staticClass:"lead text-center"},[t._v("All the markers created.")])])])]),t._v(" "),a("div",{staticClass:"col-md-6"},[a("h3",[t._v("Active markers")]),t._v(" "),a("div",{staticClass:"jumbotron jumbotron-fluid bg-dark rounded"},[a("div",{staticClass:"container"},[a("div",{staticClass:"display-4 text-center"},[t._v(t._s(t.markers.length-t.expiredMarkers.length))]),t._v(" "),a("p",{staticClass:"lead text-center"},[t._v("Markers that are currently live.")])])])])]):t._e(),t._v(" "),t.markers&&t.markers.length>0?a("map-markers-chart-component",{attrs:{markers:t.markers}}):t._e()],1)])])],1)}),[],!1,null,null,null);e.default=n.exports},oVQG:function(t,e,a){"use strict";a.r(e);var s={props:["markers"],data:function(){return{is_connected_live:!1}},mounted:function(){this.listenForSocketConnect(),this.listenForSocketDisconnect()},computed:{limitedMarkers:function(){return this.markers?this.markers.sort((function(t,e){return t.created_at<e.created_at})).slice(0,50):[]}},watch:{markers:function(t){this.handleNewMarker()}},methods:{handleClick:function(t){$("html").animate({scrollTop:$("#app").offset().top},200),this.$root.$emit("flyTo",t.location.coordinates)},listenForSocketConnect:function(){var t=this;window.Echo.connector.pusher.connection.bind("connected",(function(){t.is_connected_live=!0}))},listenForSocketDisconnect:function(){var t=this;window.Echo.connector.pusher.connection.bind("disconnected",(function(){t.is_connected_live=!1}))},handleNewMarker:function(){$("#marker_feed_markers").animate({scrollTop:$("#app").offset().top},200)}}},r=(a("Icb6"),a("KHd+")),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("ul",{staticClass:"list-unstyled px-0 pb-3 mb-3 bg-dark card",attrs:{id:"marker_feed"}},[a("li",{staticClass:"media p-3 card-header",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"collapse","data-target":"#marker_feed_markers","aria-expanded":"false","aria-controls":"marker_feed_markers"}},[a("div",{staticClass:"media-body"},[t.is_connected_live?a("h5",{staticClass:"mt-0 mb-0"},[a("i",{staticClass:"fa fa-circle text-danger blink"}),t._v(" Live feed")]):a("h5",{staticClass:"mt-0 mb-0"},[t._v("Feed")])])]),t._v(" "),a("div",{staticClass:"collapse show",staticStyle:{"max-height":"57vh","overflow-y":"scroll"},attrs:{id:"marker_feed_markers"}},[t.limitedMarkers.length>0?t._l(t.limitedMarkers,(function(e){return a("li",{key:"marker_feed_"+e.id,staticClass:"media ml-3 mr-3 p-3 mb-3 bg-secondary text-white card feed-element",on:{click:function(a){return t.handleClick(e)}}},[a("div",{staticClass:"media-body"},[a("h5",{staticClass:"mt-0 mb-1"},[t._v(t._s(e.category.name))]),t._v(" "),a("p",{staticClass:"mt-0 mb-1",domProps:{innerHTML:t._s(e.description)}}),t._v(" "),a("span",{staticClass:"timestamp small",attrs:{datetime:e.updated_at}},[t._v(t._s(e.updated_at))])])])})):[a("div",{staticClass:"text-center text-muted p-3"},[t._v("There's no active markers at this time.")])]],2)])])}),[],!1,null,null,null);e.default=n.exports},oY5b:function(t,e,a){var s=a("eGTV");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,r);s.locals&&(t.exports=s.locals)},pbe3:function(t,e,a){"use strict";a.r(e);var s=a("H8ri"),r=s.c.reactiveProp;e.default={extends:s.b,mixins:[r],props:["options"],mounted:function(){this.renderChart(this.chartData,this.options)}}},pyCd:function(t,e){},rlHA:function(t,e,a){"use strict";a.r(e);var s=a("o0o1"),r=a.n(s),n=a("JpmB"),i=a("pArE"),o=a("Tith"),l=a("9g/y"),c=a("+7pQ"),m=a("Hrto"),u=a("L2ck"),d=a("yp/A"),p=a.n(d),h=a("jl8+"),f=a.n(h),v=a("xuDP"),g=a("zCu8");function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],s=!0,r=!1,n=void 0;try{for(var i,o=t[Symbol.iterator]();!(s=(i=o.next()).done)&&(a.push(i.value),!e||a.length!==e);s=!0);}catch(t){r=!0,n=t}finally{try{s||null==o.return||o.return()}finally{if(r)throw n}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return k(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}function y(t,e,a,s,r,n,i){try{var o=t[n](i),l=o.value}catch(t){return void a(t)}o.done?e(l):Promise.resolve(l).then(s,r)}!function(t){var e,a=(e=t.documentMode,"onhashchange"in t&&(void 0===e||e>7));L.Hash=function(t){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t)},L.Hash.parseHash=function(t){0===t.indexOf("#")&&(t=t.substr(1));var e=t.split("/");if(3==e.length){var a=parseInt(e[0],10),s=parseFloat(e[1]),r=parseFloat(e[2]);return!(isNaN(a)||isNaN(s)||isNaN(r))&&{center:new L.LatLng(s,r),zoom:a}}return!1},L.Hash.formatHash=function(t){var e=t.getCenter(),a=t.getZoom(),s=Math.max(0,Math.ceil(Math.log(a)/Math.LN2));return"#"+[a,e.lat.toFixed(s),e.lng.toFixed(s)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t){this.map=t,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t=location.hash;if(t!==this.lastHash){var e=this.parseHash(t);e?(this.movingMap=!0,this.map.setView(e.center,e.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var t=this;this.changeTimeout=setTimeout((function(){t.update(),t.changeTimeout=null}),this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),a?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),a?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(t){return new L.Hash(t)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window),L.Control.Fullscreen=L.Control.extend({options:{position:"topleft",title:{false:"View Fullscreen",true:"Exit Fullscreen"}},onAdd:function(t){var e=L.DomUtil.create("div","leaflet-control-fullscreen leaflet-bar leaflet-control");return this.link=L.DomUtil.create("a","leaflet-control-fullscreen-button leaflet-bar-part",e),this.link.href="#",this._map=t,this._map.on("fullscreenchange",this._toggleTitle,this),this._toggleTitle(),L.DomEvent.on(this.link,"click",this._click,this),e},_click:function(t){L.DomEvent.stopPropagation(t),L.DomEvent.preventDefault(t),this._map.toggleFullscreen(this.options)},_toggleTitle:function(){this.link.title=this.options.title[this._map.isFullscreen()]}}),L.Map.include({isFullscreen:function(){return this._isFullscreen||!1},toggleFullscreen:function(t){var e=this.getContainer();this.isFullscreen()?t&&t.pseudoFullscreen?this._disablePseudoFullscreen(e):document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():this._disablePseudoFullscreen(e):t&&t.pseudoFullscreen?this._enablePseudoFullscreen(e):e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen?e.msRequestFullscreen():this._enablePseudoFullscreen(e)},_enablePseudoFullscreen:function(t){L.DomUtil.addClass(t,"leaflet-pseudo-fullscreen"),this._setFullscreen(!0),this.invalidateSize(),this.fire("fullscreenchange")},_disablePseudoFullscreen:function(t){L.DomUtil.removeClass(t,"leaflet-pseudo-fullscreen"),this._setFullscreen(!1),this.invalidateSize(),this.fire("fullscreenchange")},_setFullscreen:function(t){this._isFullscreen=t;var e=this.getContainer();t?L.DomUtil.addClass(e,"leaflet-fullscreen-on"):L.DomUtil.removeClass(e,"leaflet-fullscreen-on")},_onFullscreenChange:function(t){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;e!==this.getContainer()||this._isFullscreen?e!==this.getContainer()&&this._isFullscreen&&(this._setFullscreen(!1),this.fire("fullscreenchange")):(this._setFullscreen(!0),this.fire("fullscreenchange"))}}),L.Map.mergeOptions({fullscreenControl:!1}),L.Map.addInitHook((function(){var t;if(this.options.fullscreenControl&&(this.fullscreenControl=new L.Control.Fullscreen(this.options.fullscreenControl),this.addControl(this.fullscreenControl)),"onfullscreenchange"in document?t="fullscreenchange":"onmozfullscreenchange"in document?t="mozfullscreenchange":"onwebkitfullscreenchange"in document?t="webkitfullscreenchange":"onmsfullscreenchange"in document&&(t="MSFullscreenChange"),t){var e=L.bind(this._onFullscreenChange,this);this.whenReady((function(){L.DomEvent.on(document,t,e)})),this.on("unload",(function(){L.DomEvent.off(document,t,e)}))}})),L.control.fullscreen=function(t){return new L.Control.Fullscreen(t)};var C={props:["map_id","map_token","users_can_create_markers","map_categories","initial_markers","user"],components:{LMap:n.a,LTileLayer:i.a,LMarker:o.a,LPopup:l.a,"l-locatecontrol":u.a,LIcon:c.a,"l-marker-cluster":p.a,LLayerGroup:m.a,Multiselect:f.a,"v-geosearch":g.a},data:function(){return{center:L.latLng(43.704,7.3111),url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png",attribution:'&copy; <a href="https://cartes.io">Cartes.io</a> &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a> &copy; <a href="https://icons8.com/attributions">Icons8</a>',subdomains:"abcd",markers:this.initial_markers,categories:this.map_categories?this.map_categories:[],new_message:"",fullCategory:{id:null,name:""},query:"",open_marker:null,markerResults:{},submit_data:{lat:0,lng:0,category:0,description:"",category_name:"",loading:!1,map_token:this.map_token},geosearchOptions:{provider:new v.OpenStreetMapProvider,style:"button",autoClose:!0,showPopup:!0,showMarker:!1,keepResult:!0,marker:{draggable:!1}}}},created:function(){var t=this;this.$root.$on("flyTo",(function(e){return t.$refs.map.mapObject.flyTo(e,16)})),this.markers||this.getMarkers(),this.debouncedGetCategories=_.debounce(this.getCategories,250),this.debouncedRenderTimeago=_.debounce(this.renderTimeago,50)},mounted:function(){var t=this.$refs.map.mapObject;new L.Hash(t),t.addControl(new L.Control.Fullscreen),t.on("fullscreenchange",(function(){t.invalidateSize()})),t.setMaxBounds([[-90,-1/0],[90,1/0]]),localStorage.getItem("map_"+this.map_id)&&!this.submit_data.map_token?this.submit_data.map_token=localStorage.getItem("map_"+this.map_id):this.submit_data.token&&(localStorage["map_"+this.map_id]=this.submit_data.map_token)},computed:{canPost:function(){return this.submit_data.map_token?"yes":this.users_can_create_markers},activeMarkers:function(){return this.initial_markers?this.markers:this.markers?this.markers.filter((function(t){return null==t.expires_at||Vue.moment(t.expires_at).isBefore(Vue.moment())})):[]}},watch:{initial_markers:function(t){this.markers=t},map_categories:function(t){this.categories=t},map_id:function(t){this.getMarkers()}},methods:{canDeletePost:function(t){return!this.isMarkerExpired(t.expires_at)&&(!!this.submit_data.map_token||this.inLocalStorageKey(t.id))},isMarkerExpired:function(t){return!!t&&Vue.moment(t).isBefore(Vue.moment())},addMarkerMenu:function(t){this.$refs.hello_popup.mapObject.openPopup(t.latlng),this.submit_data.category||$(".multiselect").focus(),this.submit_data.lat=t.latlng.lat,this.submit_data.lng=t.latlng.lng},handleOpenedPopup:function(t,e){var a,s=this;return(a=r.a.mark((function a(){var n;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(s.open_marker=s.markers.findIndex((function(t){return t.id===e})),!s.markers[s.open_marker]||!s.markers[s.open_marker].marker){a.next=4;break}a.next=9;break;case 4:return Vue.set(s.markers[s.open_marker],"marker",{label:"One sec, we're fetching the address..."}),a.next=7,s.geosearchOptions.provider.search({query:t.latlng.lat+" "+t.latlng.lng});case 7:n=a.sent,Vue.set(s.markers[s.open_marker],"marker",n[0]);case 9:case"end":return a.stop()}}),a)})),function(){var t=this,e=arguments;return new Promise((function(s,r){var n=a.apply(t,e);function i(t){y(n,s,r,i,o,"next",t)}function o(t){y(n,s,r,i,o,"throw",t)}i(void 0)}))})()},openPopup:function(t){this.debouncedRenderTimeago()},renderTimeago:function(){timeago.render(document.querySelectorAll(".timestamp"))},addTag:function(t){var e={category_id:-1,name:t,icon:"/images/marker-01.svg"};this.categories.push(e),this.fullCategory=e,this.submit_data.category=e.category_id,this.submit_data.category_name=e.name},handleSelectInput:function(t){this.submit_data.category=t.id,this.submit_data.category_name=t.name},inLocalStorageKey:function(t){return!!localStorage["post_"+t]},asyncFind:function(t){if(t.length<3)return!1;this.submit_data.loading=!0,this.query=t,this.debouncedGetCategories()},getMarkers:function(){var t=this;return axios.get("/api/maps/"+this.map_id+"/markers").then((function(e){return t.markers=e.data}))},getCategories:function(t){var e=this;return axios.get("/api/categories?query="+this.query).then((function(t){e.categories=t.data,e.submit_data.loading=!1}))},deleteMarker:function(t){var e=this;return this.submit_data.loading=!0,axios.delete("/api/maps/"+this.map_id+"/markers/"+t,{data:{token:localStorage["post_"+t],map_token:this.submit_data.map_token}}).then((function(a){e.handleDeletedMarker(t),e.submit_data.loading=!1}))},handleDeletedMarker:function(t){this.markers=this.markers.filter((function(e){return e.id!==t})),localStorage.removeItem("post_"+t),this.$emit("marker-delete",t)},addMarker:function(){var t=this;return this.submit_data.loading=!0,axios.post("/api/maps/"+this.map_id+"/markers",this.submit_data).then((function(e){t.$refs.hello_popup.mapObject.closePopup(),t.submit_data.loading=!1,t.submit_data.description="",t.initial_markers||t.markers.push(e.data),localStorage["post_"+e.data.id]=e.data.token,dataLayer.push({event:"marker-create"}),t.$emit("marker-create",e.data)})).catch((function(e){if(t.submit_data.loading=!1,console.log(e),e.response.data.errors)var a=Object.entries(e.response.data.errors).map((function(t,e){var a=b(t,2),s=a[0],r=a[1];return"".concat(s,": ").concat(r[0]," | ")})).join("\n");else a=e.response.data.message;alert(a)}))}}},w=(a("UtuO"),a("KHd+")),x=Object(w.a)(C,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("l-map",{ref:"map",staticStyle:{width:"100%",height:"100%"},attrs:{zoom:2,center:t.center,maxBoundsViscosity:1,worldCopyJump:!0},on:{contextmenu:t.addMarkerMenu}},[a("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),t._v(" "),a("l-locatecontrol"),t._v(" "),a("v-geosearch",{attrs:{options:t.geosearchOptions}}),t._v(" "),a("l-layer-group",{ref:"hello_popup"},[a("l-popup",["yes"==t.canPost||"only_logged_in"==t.canPost&&t.user&&t.user.id?a("form",{attrs:{method:"POST",action:"/markers",disabled:!t.submit_data.category_name},on:{submit:function(e){return e.preventDefault(),t.addMarker()}}},[a("label",{staticClass:"my-1 mr-2"},[t._v("Marker label:")]),t._v(" "),a("multiselect",{staticClass:"your_custom_class",staticStyle:{width:"250px"},attrs:{"track-by":"name",label:"name",placeholder:"Start typing...","tag-placeholder":"Add this as new label",options:t.categories,searchable:!0,"allow-empty":!1,taggable:!0,"show-labels":!1,loading:t.submit_data.loading,"internal-search":!1,"clear-on-select":!1,"options-limit":300,limit:3,"max-height":600,"show-no-results":!1,"preserve-search":!0,required:""},on:{input:t.handleSelectInput,tag:t.addTag,"search-change":t.asyncFind},scopedSlots:t._u([{key:"limit",fn:function(e){e.option;return[t._v("Keep typing to refine your search")]}},{key:"singleLabel",fn:function(e){var s=e.option;return[a("strong",[t._v(t._s(s.name))])]}},{key:"option",fn:function(e){return[e.option.icon?a("img",{staticClass:"rounded img-thumbnail mr-1",staticStyle:{position:"initial"},attrs:{height:"25",width:"25",src:e.option.icon,alt:""}}):t._e(),t._v(t._s(e.option.name)+"\n                            ")]}}],null,!1,756316684),model:{value:t.fullCategory,callback:function(e){t.fullCategory=e},expression:"fullCategory"}},[t._v(" "),a("template",{slot:"noOptions"},[t._v("Search for or add a new label")])],2),t._v(" "),a("div",{staticClass:"form-group mt-1"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.submit_data.description,expression:"submit_data.description"}],staticClass:"form-control",attrs:{id:"description",rows:"2",name:"description",placeholder:"Description (optional)"},domProps:{value:t.submit_data.description},on:{input:function(e){e.target.composing||t.$set(t.submit_data,"description",e.target.value)}}})]),t._v(" "),a("input",{staticClass:"btn btn-primary btn-sm my-1",attrs:{type:"submit",value:"Add marker",disabled:t.submit_data.loading||!t.submit_data.category_name}})],1):"only_logged_in"==t.canPost?a("div",[a("a",{attrs:{href:"/login"}},[t._v("Log in")]),t._v(" to Cartes.io to post on this map.")]):a("div",[t._v("You can't create markers on this map.")])])],1),t._v(" "),a("l-marker-cluster",t._l(t.activeMarkers,(function(e){return a("l-marker",{key:e.id+"marker",attrs:{"lat-lng":e.location.coordinates},on:{click:function(a){return t.handleOpenedPopup(a,e.id)}}},[a("l-icon",{attrs:{"icon-url":e.category.icon,"icon-size":[30,30],"icon-anchor":[15,25]}}),t._v(" "),a("l-popup",{on:{ready:t.openPopup}},[a("p",{staticClass:"mb-1",staticStyle:{"min-width":"200px"}},[a("b",[t._v(t._s(e.category.name))])]),t._v(" "),e.description?a("p",{staticClass:"mb-1 mt-0 w-100 d-block",domProps:{innerHTML:t._s(e.description)}}):t._e(),t._v(" "),a("small",{staticClass:"w-100 d-block"},[t._v("Last report: "),a("span",{staticClass:"timestamp",attrs:{datetime:e.updated_at}},[t._v(t._s(e.updated_at))]),t._v(".")]),t._v(" "),t.isMarkerExpired(e.expires_at)?a("small",{staticClass:"w-100 d-block"},[t._v("Expired: "),a("span",{staticClass:"timestamp",attrs:{datetime:e.expires_at}},[t._v(t._s(e.expires_at))]),t._v(".")]):t._e(),t._v(" "),e.marker?a("details",{staticClass:"small"},[a("summary",[t._v("Click to see address")]),t._v(" "),a("p",{staticClass:"mt-0 mb-1"},[t._v(t._s(e.marker.label))])]):t._e(),t._v(" "),t.canDeletePost(e)?a("a",{staticClass:"btn btn-link btn-sm text-danger",attrs:{disabled:t.submit_data.loading},on:{click:function(a){return t.deleteMarker(e.id)}}},[t._v("Delete")]):t._e()])],1)})),1)],1),t._v(" "),t.new_message?a("div",{staticClass:"alert bg-primary map-notification",attrs:{role:"alert"}},[a("h4",{staticClass:"alert-heading"},[t._v("A new marker was created")]),t._v(" "),a("p",{staticClass:"mb-0"},[t._v(t._s(t.new_message))])]):t._e()],1)}),[],!1,null,null,null);e.default=x.exports},tq84:function(t,e,a){"use strict";a.r(e);var s=a("fWYB"),r=a("+QRC"),n=a.n(r);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var a=[],s=!0,r=!1,n=void 0;try{for(var i,o=t[Symbol.iterator]();!(s=(i=o.next()).done)&&(a.push(i.value),!e||a.length!==e);s=!0);}catch(t){r=!0,n=t}finally{try{s||null==o.return||o.return()}finally{if(r)throw n}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var l={props:["map_id","map_token","map"],components:{NavigatorShare:s.a},data:function(){return{submit_data:{title:this.map.title,description:this.map.description,token:this.map_token,privacy:this.map.privacy,users_can_create_markers:this.map.users_can_create_markers,loading:!1,options:{default_expiration_time:this.map.options&&this.map.options.default_expiration_time?this.map.options.default_expiration_time:null,limit_to_geographical_body_type:this.map.options&&this.map.options.limit_to_geographical_body_type?this.map.options.limit_to_geographical_body_type:null}}}},mounted:function(){localStorage["map_"+this.map_id]&&!this.submit_data.token?this.submit_data.token=localStorage["map_"+this.map_id]:this.submit_data.token&&(localStorage["map_"+this.map_id]=this.submit_data.token)},computed:{map_url:function(){return window.location.href},canEdit:function(){return!!this.submit_data.token}},watch:{title:function(t,e){this.submit_data.title="Waiting for you to stop typing...",this.debouncedGetAnswer()}},created:function(){this.debouncedGetAnswer=_.debounce(this.submitForm,950)},methods:{onShareError:function(t){n()(this.map_url,{message:"Press #{key} to copy",onCopy:alert("Link copied")})},handleSelectInput:function(t,e){"privacy"==e||"users_can_create_markers"==e?this.submit_data[e]=t.target.value:"options.default_expiration_time"==e?this.submit_data.options.default_expiration_time=t.target.value:"options.limit_to_geographical_body_type"==e?this.submit_data.options.limit_to_geographical_body_type=t.target.value:this.submit_data[e]=t.target.innerText,this.debouncedGetAnswer()},checkForLocalStorageKey:function(t){return!!localStorage["map_"+t]},submitForm:function(t){var e=this;this.submit_data.loading=!0,axios.put("/api/maps/"+this.map_id,this.submit_data).then((function(t){e.submit_data.loading=!1,e.$emit("map-update",t.data)})).catch((function(t){if(e.submit_data.loading=!1,console.log(t),t.response.data.errors)var a=Object.entries(t.response.data.errors).map((function(t,e){var a=i(t,2),s=a[0],r=a[1];return"".concat(s,": ").concat(r[0]," | ")})).join("\n");else a=t.response.data.message;alert(a)}))},deleteMap:function(t){var e=this;confirm("You'll never see this map again. Are you sure?")&&(this.submit_data.loading=!0,axios.delete("/api/maps/"+this.map_id,{data:{token:this.submit_data.token}}).then((function(t){localStorage.removeItem("map_"+e.map_id),alert("This map has gone with the wind!"),window.location.href="/",e.submit_data.loading=!1})).catch((function(t){e.submit_data.loading=!1,alert(t.message)})))}}},c=(a("vnus"),a("KHd+")),m=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-7"},[t.map&&t.map.title||!t.canEdit?t.submit_data.title?a("h1",{staticClass:"w-100",attrs:{contenteditable:t.canEdit},on:{input:function(e){return t.handleSelectInput(e,"title")}}},[t._v(t._s(t.map.title))]):a("h1",[t._v("Untitled map")]):a("h1",{staticClass:"w-100",attrs:{contenteditable:t.canEdit},on:{input:function(e){return t.handleSelectInput(e,"title")}}},[t._v("Here's your new map!"),t.canEdit?a("small",{staticClass:"text-muted"},[t._v(" (Click to edit the title)")]):t._e()]),t._v(" "),t.map&&t.map.description||!t.canEdit?t.map&&t.map.description?a("p",{staticStyle:{"white-space":"pre-wrap"},attrs:{contenteditable:t.canEdit},domProps:{innerHTML:t._s(t.map.description)},on:{input:function(e){return t.handleSelectInput(e,"description")}}}):a("p",[t._v("This map has no description.")]):a("p",{staticStyle:{"white-space":"pre-wrap"},attrs:{contenteditable:t.canEdit},on:{input:function(e){return t.handleSelectInput(e,"description")}}},[t._v("Right click (or long-tap on mobile) on the map to add markers. Click here to edit the map description.")])]),t._v(" "),a("div",{staticClass:"col-md-5 mt-5 mt-md-0"},[a("navigator-share",{staticClass:"mb-3",attrs:{"on-error":t.onShareError,url:t.map_url,title:t.submit_data.title?t.submit_data.title:"Untitled map",text:t.submit_data.description?t.submit_data.description:"Here's my map"}},[a("a",{staticClass:"btn btn-primary btn-lg btn-block",attrs:{slot:"clickable"},slot:"clickable"},[t._v("Share this map")])]),t._v(" "),t._t("default"),t._v(" "),t.canEdit?a("div",{key:"map-settings",staticClass:"card bg-dark text-white mb-3"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body collapse",attrs:{id:"settingsCollapse"}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label",attrs:{for:"password-confirm"}},[t._v("Who can see this map")]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"privacy",id:"exampleRadios1",value:"public"},domProps:{checked:"public"==t.submit_data.privacy},on:{input:function(e){return t.handleSelectInput(e,"privacy")}}}),t._v(" "),t._m(1)]),t._v(" "),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"privacy",id:"exampleRadios2",value:"unlisted"},domProps:{checked:"unlisted"==t.submit_data.privacy},on:{input:function(e){return t.handleSelectInput(e,"privacy")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios2"}},[t._v("\n                                Only people with a link\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check disabled"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"privacy",id:"exampleRadios3",value:"private",disabled:""},on:{input:function(e){return t.handleSelectInput(e,"privacy")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios3"}},[t._v("\n                                No one\n                            ")])])])]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label",attrs:{for:"users_can_create_markers"}},[t._v("Who can create markers")]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"users_can_create_markers",id:"exampleRadios4",value:"yes"},domProps:{checked:"yes"==t.submit_data.users_can_create_markers},on:{input:function(e){return t.handleSelectInput(e,"users_can_create_markers")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios4"}},[t._v("\n                                Anyone\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"users_can_create_markers",id:"exampleRadios5",value:"only_logged_in"},domProps:{checked:"only_logged_in"==t.submit_data.users_can_create_markers},on:{input:function(e){return t.handleSelectInput(e,"users_can_create_markers")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios5"}},[t._v("\n                                Only people that are logged in\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"users_can_create_markers",id:"exampleRadios6",value:"no"},domProps:{checked:"no"==t.submit_data.users_can_create_markers},on:{input:function(e){return t.handleSelectInput(e,"users_can_create_markers")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios6"}},[t._v("\n                                No one\n                            ")])]),t._v(" "),t.canEdit?a("small",[t._v("You can add markers to your own map regardless of this setting")]):t._e()])]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label",attrs:{for:"password-confirm"}},[t._v("When should new markers dissapear from the map")]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.default_expiration_time",id:"cdet1",value:"4320"},domProps:{checked:4320==t.submit_data.options.default_expiration_time},on:{input:function(e){return t.handleSelectInput(e,"options.default_expiration_time")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet1"}},[t._v("\n                                after 3 days\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.default_expiration_time",id:"cdet2",value:"180"},domProps:{checked:180==t.submit_data.options.default_expiration_time},on:{input:function(e){return t.handleSelectInput(e,"options.default_expiration_time")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet2"}},[t._v("\n                                after 3 hours\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check disabled"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.default_expiration_time",id:"cdet3"},domProps:{value:null,checked:null==t.submit_data.options.default_expiration_time},on:{input:function(e){return t.handleSelectInput(e,"options.default_expiration_time")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet3"}},[t._v("\n                                Never\n                            ")])])])]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-md-12 col-form-label",attrs:{for:"password-confirm"}},[t._v("Where can markers be placed")]),t._v(" "),a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.limit_to_geographical_body_type",id:"cdet1",value:"land"},domProps:{checked:"land"==t.submit_data.options.limit_to_geographical_body_type},on:{input:function(e){return t.handleSelectInput(e,"options.limit_to_geographical_body_type")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet1"}},[t._v("\n                                Only on land\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.limit_to_geographical_body_type",id:"cdet2",value:"water"},domProps:{checked:"water"==t.submit_data.options.limit_to_geographical_body_type},on:{input:function(e){return t.handleSelectInput(e,"options.limit_to_geographical_body_type")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet2"}},[t._v("\n                                Only on water\n                            ")])]),t._v(" "),a("div",{staticClass:"form-check disabled"},[a("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"options.limit_to_geographical_body_type",id:"cdet3"},domProps:{value:null,checked:null==t.submit_data.options.limit_to_geographical_body_type},on:{input:function(e){return t.handleSelectInput(e,"options.limit_to_geographical_body_type")}}}),t._v(" "),a("label",{staticClass:"form-check-label",attrs:{for:"cdet3"}},[t._v("\n                                Anywhere\n                            ")])]),t._v(" "),a("small",[t._v('Setting this to "water" or "land" will also drastically limit how many markers can be created on this map per minute')])])]),t._v(" "),t.canEdit?a("a",{staticClass:"btn btn-danger btn-sm mt-3",attrs:{disabled:t.submit_data.loading},on:{click:t.deleteMap}},[t._v("Delete map")]):t._e()])]):t._e(),t._v(" "),a("p",{staticClass:"small"},[t._v("Right click (or long-tap on mobile) on the map to create a marker. You can choose one of the existing labels or create your own.")]),t._v(" "),t.submit_data.options.default_expiration_time?a("p",{staticClass:"small mb-3"},[t._v(t._s(t.submit_data.options.default_expiration_time/60)+" hours after creating a marker it will automatically dissapear from the map.")]):t._e(),t._v(" "),t.map.categories?a("div",{staticClass:"d-flex mt-3",staticStyle:{"flex-wrap":"wrap","max-height":"30vh","overflow-x":"scroll"}},t._l(t.map.categories,(function(e){return a("a",{key:e.id,staticClass:"badge badge-secondary mr-1 mb-1",attrs:{href:"#"}},[t._v(t._s(e.name))])})),0):t._e(),t._v(" "),a("details",{staticClass:"mt-3 mb-3 small"},[t._m(2),t._v(" "),a("div",[t._m(3),t._v(" "),a("div",{staticClass:"mb-3"},[t._m(4),t._v(" "),a("code",[t._v("/api/maps/"+t._s(t.map.uuid))])]),t._v(" "),a("div",{staticClass:"mb-3"},[t._m(5),t._v(" "),a("code",[t._v("/api/maps/"+t._s(t.map.uuid)+"/markers")])]),t._v(" "),a("div",{staticClass:"mb-3"},[a("p",{staticClass:"mb-0"},[t._v("Embed this map on your website")]),t._v(" "),a("code",[t._v('<iframe src="https://cartes.io/embeds/maps/'+t._s(t.map.uuid)+'?type=map" width="100%" height="400" frameborder="0"></iframe>')])]),t._v(" "),a("p",[t._v("When using the API or embedding the map, you must attribute this website on your front-end.")])])])],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header",staticStyle:{cursor:"pointer"},attrs:{"data-toggle":"collapse","data-target":"#settingsCollapse","aria-expanded":"false","aria-controls":"settingsCollapse"}},[e("i",{staticClass:"fa fa-cog"}),this._v(" Map settings")])},function(){var t=this.$createElement,e=this._self._c||t;return e("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios1"}},[this._v("\n                                Everyone "),e("small",[this._v("(make this map public)")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("summary",[e("dt",{staticClass:"d-inline text-muted"},[this._v("Developer info")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Use standard API requests to get data from this map. No authentication required for public and unlisted maps. "),e("a",{attrs:{href:"https://github.com/M-Media-Group/Cartes.io/wiki/API",rel:"noopener",target:"_BLANK"}},[this._v("Read the docs")]),this._v(".")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"mb-0"},[this._v("API "),e("code",[this._v("GET")]),this._v(" map endpoint")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"mb-0"},[this._v("API "),e("code",[this._v("GET")]),this._v(" markers endpoint")])}],!1,null,null,null);e.default=m.exports},vMva:function(t,e,a){"use strict";a.r(e);var s={props:["markers"],data:function(){return{datacollection:{},timedatacollection:{},show_all:!0,chartLineOptions:{onClick:this.handleClick,scales:{xAxes:[{type:"time",distribution:"linear"}]}}}},mounted:function(){this.markers&&(this.fillChartData(),this.fillPieData())},computed:{},watch:{markers:function(t){this.fillChartData(),this.fillPieData()}},methods:{groupBy:function(t,e){var a=new Map;return t.forEach((function(t){var s=e(t),r=a.get(s);r?r.push(t):a.set(s,[t])})),a},fillChartData:function(){var t=this.groupBy(this.markers,(function(t){return Vue.moment(t.created_at).startOf("hour").toString()}));this.timedatacollection={labels:Array.from(t).map((function(t){return t[0]})),datasets:[{label:"Markers",borderColor:"#1C77C3",data:Array.from(t).map((function(t){return t[1].length}))}]}},fillPieData:function(){var t=this.groupBy(this.markers,(function(t){return t.category.name}));this.datacollection={labels:Array.from(t).map((function(t){return t[0]})),datasets:[{label:"New markers",borderColor:"#1C77C3",data:Array.from(t).map((function(t){return t[1].length}))}]}},handleClick:function(t,e){var a=e[0],s=a._index,r=a._chart.data.labels[s];a._chart.data.datasets[0].data[s];this.$emit("clicked-date",{index:a._index,backgroundColor:a._view.backgroundColor,value:r})}}},r=a("KHd+"),n=Object(r.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.markers&&t.markers.length>1?a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("h3",[t._v("Marker type distribution")]),t._v(" "),a("chart-pie-component",{staticClass:"mt-5 mb-5",staticStyle:{width:"100%"},attrs:{"chart-data":t.datacollection,height:225}})],1),t._v(" "),a("div",{staticClass:"col-md-6"},[a("h3",[t._v("New markers by date")]),t._v(" "),a("chart-line-component",{staticClass:"mt-5 mb-5",staticStyle:{width:"100%"},attrs:{"chart-data":t.timedatacollection,options:t.chartLineOptions,height:225}})],1)]):a("div",[a("p",{staticClass:"small"},[t._v("There's not enough markers on this map yet. More stats will be available after a few more markers are added.")])])}),[],!1,null,null,null);e.default=n.exports},vnus:function(t,e,a){"use strict";var s=a("oY5b");a.n(s).a},xzCv:function(t,e,a){var s=a("eLWi");"string"==typeof s&&(s=[[t.i,s,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(s,r);s.locals&&(t.exports=s.locals)}},[[0,1,2]]]);
//# sourceMappingURL=app.js.map