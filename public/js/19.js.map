{"version":3,"sources":["webpack://site/./resources/js/components/MapContainerComponent.vue?47f1","webpack://site/./resources/js/components/MapContainerComponent.vue?2460","webpack://site/resources/js/components/MapContainerComponent.vue","webpack://site/./resources/js/components/MapContainerComponent.vue?b7e5","webpack://site/./resources/js/components/MapContainerComponent.vue?7544","webpack://site/./resources/js/components/MapContainerComponent.vue"],"names":["___CSS_LOADER_EXPORT___","push","module","id","props","initial_map","Object","initial_markers","initial_map_token","type","String","required","user","default","components","data","map","this","map_token","markers","map_settings","show_all","mapSelectedAge","created","getAllMarkers","listenForNewMarkers","listenForDeletedMarkers","mounted","computed","mapAgeInMinutes","Math","abs","Vue","moment","diff","created_at","nonSpamMarkers","filter","marker","is_spam","localStorage","activeMarkers","expiredMarkers","expires_at","isAfter","hasLiveData","users_can_create_markers","categories","map1","watch","methods","groupBy","list","forEach","collection","item","set","key","Echo","channel","uuid","listen","title","e","category","name","text","description","handleMarkerCreate","handleMarkerDelete","$notify","handleMapUpdate","handleApiMarkers","markerInLocalStorageKey","options","_vm","_h","$createElement","_c","_self","staticStyle","attrs","on","staticClass","_v","_e","_s","directives","rawName","value","expression","domProps","$event","$set","target","Array","isArray","_i","$$a","$$el","$$c","checked","$$i","concat","slice","length"],"mappings":"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","file":"js/19.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#formControlRange{direction:rtl}\", \"\",{\"version\":3,\"sources\":[\"webpack://./resources/js/components/MapContainerComponent.vue\"],\"names\":[],\"mappings\":\"AAyUA,kBACA,aACA\",\"sourcesContent\":[\"<template>\\n  <div>\\n    <map-component\\n      v-if=\\\"map\\\"\\n      :map_id=\\\"map.uuid\\\"\\n      :map_token=\\\"map_token\\\"\\n      style=\\\"height: 65vh\\\"\\n      :users_can_create_markers=\\\"map.users_can_create_markers\\\"\\n      :map_categories=\\\"categories\\\"\\n      :initial_markers=\\\"activeMarkers\\\"\\n      v-on:marker-create=\\\"handleMarkerCreate\\\"\\n      v-on:marker-delete=\\\"handleMarkerDelete\\\"\\n      :user=\\\"user\\\"\\n    ></map-component>\\n    <div v-else style=\\\"height: 65vh\\\" class=\\\"row align-items-center bg-dark\\\">\\n      <div class=\\\"col text-center\\\">\\n        <div>Cartes.io</div>\\n        <p class=\\\"text-muted mb-0\\\">Contacting planet Earth...</p>\\n      </div>\\n    </div>\\n    <div class=\\\"container\\\">\\n      <div class=\\\"row justify-content-center mt-5\\\">\\n        <div class=\\\"col-md-12\\\" style=\\\"max-width: 950px\\\">\\n          <map-details-component\\n            :map_id=\\\"map.uuid\\\"\\n            :map_token=\\\"map_token\\\"\\n            :map=\\\"map\\\"\\n            v-on:map-update=\\\"handleMapUpdate\\\"\\n          >\\n            <map-markers-feed-component\\n              v-if=\\\"hasLiveData\\\"\\n              :markers=\\\"activeMarkers\\\"\\n            ></map-markers-feed-component>\\n            <div class=\\\"card bg-dark text-white mb-3\\\">\\n              <div\\n                class=\\\"card-header\\\"\\n                data-toggle=\\\"collapse\\\"\\n                data-target=\\\"#displayCollapse\\\"\\n                aria-expanded=\\\"false\\\"\\n                aria-controls=\\\"displayCollapse\\\"\\n                style=\\\"cursor: pointer\\\"\\n              >\\n                <i class=\\\"fa fa-sliders\\\"></i> Map display options\\n              </div>\\n              <div class=\\\"card-body collapse\\\" id=\\\"displayCollapse\\\">\\n                <div class=\\\"form-group row\\\" v-if=\\\"!map_settings.show_all\\\">\\n                  <label class=\\\"col-md-12 col-form-label\\\" for=\\\"formControlRange\\\"\\n                    >Time slider\\n                    <small v-if=\\\"map_settings.mapSelectedAge > 0\\\"\\n                      >(showing map as of\\n                      {{ map_settings.mapSelectedAge }} minutes ago)</small\\n                    >\\n                    <small v-else>(showing live map)</small>\\n                  </label>\\n                  <div class=\\\"col-md-12\\\">\\n                    <input\\n                      type=\\\"range\\\"\\n                      class=\\\"form-control-range w-100\\\"\\n                      id=\\\"formControlRange\\\"\\n                      :max=\\\"mapAgeInMinutes\\\"\\n                      step=\\\"5\\\"\\n                      min=\\\"0\\\"\\n                      v-model=\\\"map_settings.mapSelectedAge\\\"\\n                    />\\n                  </div>\\n                </div>\\n                <div class=\\\"form-group row\\\">\\n                  <label class=\\\"col-md-12 col-form-label\\\"\\n                    >Visible markers</label\\n                  >\\n                  <div class=\\\"col-md-12\\\">\\n                    <div class=\\\"form-check\\\">\\n                      <input\\n                        type=\\\"checkbox\\\"\\n                        id=\\\"show_all_checkbox\\\"\\n                        v-model=\\\"map_settings.show_all\\\"\\n                      />\\n                      <label class=\\\"form-check-label\\\" for=\\\"show_all_checkbox\\\">\\n                        Show all markers\\n                      </label>\\n                    </div>\\n                  </div>\\n                </div>\\n              </div>\\n            </div>\\n            <!--                         <api-data-transformer-component v-on:markers-updated=\\\"handleApiMarkers\\\"></api-data-transformer-component>\\n -->\\n          </map-details-component>\\n          <h2 class=\\\"mt-5\\\" v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\">\\n            Map stats\\n          </h2>\\n          <div class=\\\"row\\\" v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\">\\n            <div class=\\\"col-md-6\\\">\\n              <h3>Total markers</h3>\\n              <div class=\\\"jumbotron jumbotron-fluid bg-dark rounded\\\">\\n                <div class=\\\"container\\\">\\n                  <div class=\\\"display-4 text-center\\\">\\n                    {{ nonSpamMarkers.length }}\\n                  </div>\\n                  <p class=\\\"lead text-center\\\">All the markers created.</p>\\n                </div>\\n              </div>\\n            </div>\\n            <div class=\\\"col-md-6\\\">\\n              <h3>Active markers</h3>\\n              <div class=\\\"jumbotron jumbotron-fluid bg-dark rounded\\\">\\n                <div class=\\\"container\\\">\\n                  <div class=\\\"display-4 text-center\\\">\\n                    {{ nonSpamMarkers.length - expiredMarkers.length }}\\n                  </div>\\n                  <p class=\\\"lead text-center\\\">\\n                    Markers that are currently live.\\n                  </p>\\n                </div>\\n              </div>\\n            </div>\\n          </div>\\n          <map-markers-chart-component\\n            v-if=\\\"nonSpamMarkers && nonSpamMarkers.length > 0\\\"\\n            :markers=\\\"markers\\\"\\n          ></map-markers-chart-component>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n</template>\\n<script lang=\\\"ts\\\">\\nimport axios from \\\"axios\\\";\\nexport default {\\n  // props: ['initial_map', 'initial_markers', 'initial_map_token', 'user'],\\n\\n  props: {\\n    // Basic type check (`null` and `undefined` values will pass any type validation)\\n    initial_map: Object,\\n    // Multiple possible types\\n    initial_markers: Object,\\n    // Required string\\n    initial_map_token: {\\n      type: String,\\n      required: false,\\n    },\\n    // Object with a default value\\n    user: {\\n      type: Object,\\n      // Object or array defaults must be returned from\\n      // a factory function\\n      default: function () {\\n        return {};\\n      },\\n    },\\n  },\\n\\n  components: {},\\n\\n  data() {\\n    return {\\n      map: this.initial_map,\\n      map_token: this.initial_map_token,\\n      markers: this.initial_markers,\\n      map_settings: {\\n        show_all: false,\\n        mapSelectedAge: 0,\\n      },\\n    };\\n  },\\n\\n  created() {\\n    if (!this.markers) {\\n      this.getAllMarkers();\\n    }\\n    this.listenForNewMarkers();\\n    this.listenForDeletedMarkers();\\n  },\\n\\n  mounted() {},\\n\\n  computed: {\\n    mapAgeInMinutes() {\\n      if (!this.map) {\\n        return false;\\n      }\\n      return Math.abs(Vue.moment().diff(this.map.created_at, \\\"minutes\\\"));\\n    },\\n    nonSpamMarkers() {\\n      if (!this.markers) {\\n        return [];\\n      }\\n      return this.markers.filter(function (marker) {\\n        if (marker.is_spam && !localStorage[\\\"post_\\\" + marker.id]) {\\n          return false;\\n        }\\n        return true;\\n      });\\n    },\\n    activeMarkers() {\\n      if (!this.markers) {\\n        return [];\\n      } else if (this.map_settings.show_all) {\\n        return this.nonSpamMarkers;\\n      }\\n\\n      let diff_date_time = Vue.moment().subtract(\\n        this.map_settings.mapSelectedAge,\\n        \\\"minutes\\\"\\n      );\\n\\n      return this.nonSpamMarkers.filter(function (marker) {\\n        if (\\n          Vue.moment(marker.created_at).isSameOrBefore(\\n            diff_date_time,\\n            \\\"minute\\\"\\n          ) &&\\n          (marker.expires_at == null ||\\n            Vue.moment(diff_date_time).isBefore(marker.expires_at))\\n        ) {\\n          return true;\\n        }\\n        return false;\\n      });\\n    },\\n    expiredMarkers() {\\n      if (!this.nonSpamMarkers) {\\n        return [];\\n      }\\n      return this.nonSpamMarkers.filter(function (marker) {\\n        if (!marker.expires_at) {\\n          return false;\\n        }\\n        return Vue.moment().isAfter(Vue.moment(marker.expires_at));\\n        //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\\n      });\\n    },\\n    hasLiveData() {\\n      if (!this.map) {\\n        return false;\\n      }\\n      if (this.map.users_can_create_markers === \\\"no\\\") {\\n        return false;\\n      }\\n      if (this.markers < 1) {\\n        return false;\\n      }\\n      return true;\\n    },\\n    categories() {\\n      if (!this.markers) {\\n        return [];\\n      }\\n      var map1 = this.markers.map((x) => x.category);\\n      return (\\n        map1\\n          .map((e) => e.id)\\n          // store the indexes of the unique objects\\n          .map((e, i, final) => final.indexOf(e) === i && i)\\n          // eliminate the false indexes & return unique objects\\n          .filter((e) => map1[e])\\n          .map((e) => map1[e])\\n      );\\n    },\\n  },\\n\\n  watch: {},\\n\\n  methods: {\\n    groupBy(list, keyGetter) {\\n      const map = new Map();\\n      list.forEach((item) => {\\n        const key = keyGetter(item);\\n        const collection = map.get(key);\\n        if (!collection) {\\n          map.set(key, [item]);\\n        } else {\\n          collection.push(item);\\n        }\\n      });\\n      return map;\\n    },\\n\\n    getAllMarkers() {\\n      axios\\n        .get(\\\"/api/maps/\\\" + this.map.uuid + \\\"/markers?show_expired=true\\\")\\n        .then((response) => (this.markers = response.data));\\n    },\\n\\n    listenForNewMarkers() {\\n      Echo.channel(\\\"maps.\\\" + this.map.uuid).listen(\\\"MarkerCreated\\\", (e) => {\\n        // this.$notify(\\\"A new marker was just added\\\")\\n        this.$notify({\\n          type: \\\"success\\\",\\n          title: '\\\"' + e.marker.category.name + '\\\" marker was just added',\\n          text: e.marker.description,\\n        });\\n        this.handleMarkerCreate(e.marker);\\n      });\\n    },\\n\\n    listenForDeletedMarkers() {\\n      Echo.channel(\\\"maps.\\\" + this.map.uuid).listen(\\\"MarkerDeleted\\\", (e) => {\\n        this.handleMarkerDelete(e.marker.id);\\n      });\\n    },\\n\\n    handleMarkerCreate(marker) {\\n      this.markers.push(marker);\\n    },\\n\\n    handleMarkerDelete(id) {\\n      this.$notify(\\\"A marker was just deleted\\\");\\n      this.markers = this.markers.filter((e) => e.id !== id);\\n    },\\n\\n    handleMapUpdate(map) {\\n      this.$notify(\\\"Information about this map has been updated\\\");\\n      this.map = map;\\n    },\\n\\n    handleApiMarkers(markers) {\\n      this.markers = markers;\\n    },\\n    markerInLocalStorageKey(id) {\\n      if (localStorage[\\\"post_\\\" + id]) {\\n        return true;\\n      }\\n      return false;\\n    },\\n  },\\n};\\n</script>\\n<style>\\n#formControlRange {\\n  direction: rtl;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[(_vm.map)?_c('map-component',{staticStyle:{\"height\":\"65vh\"},attrs:{\"map_id\":_vm.map.uuid,\"map_token\":_vm.map_token,\"users_can_create_markers\":_vm.map.users_can_create_markers,\"map_categories\":_vm.categories,\"initial_markers\":_vm.activeMarkers,\"user\":_vm.user},on:{\"marker-create\":_vm.handleMarkerCreate,\"marker-delete\":_vm.handleMarkerDelete}}):_c('div',{staticClass:\"row align-items-center bg-dark\",staticStyle:{\"height\":\"65vh\"}},[_c('div',{staticClass:\"col text-center\"},[_c('div',[_vm._v(\"Cartes.io\")]),_vm._v(\" \"),_c('p',{staticClass:\"text-muted mb-0\"},[_vm._v(\"Contacting planet Earth...\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"row justify-content-center mt-5\"},[_c('div',{staticClass:\"col-md-12\",staticStyle:{\"max-width\":\"950px\"}},[_c('map-details-component',{attrs:{\"map_id\":_vm.map.uuid,\"map_token\":_vm.map_token,\"map\":_vm.map},on:{\"map-update\":_vm.handleMapUpdate}},[(_vm.hasLiveData)?_c('map-markers-feed-component',{attrs:{\"markers\":_vm.activeMarkers}}):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"card bg-dark text-white mb-3\"},[_c('div',{staticClass:\"card-header\",staticStyle:{\"cursor\":\"pointer\"},attrs:{\"data-toggle\":\"collapse\",\"data-target\":\"#displayCollapse\",\"aria-expanded\":\"false\",\"aria-controls\":\"displayCollapse\"}},[_c('i',{staticClass:\"fa fa-sliders\"}),_vm._v(\" Map display options\\n             \")]),_vm._v(\" \"),_c('div',{staticClass:\"card-body collapse\",attrs:{\"id\":\"displayCollapse\"}},[(!_vm.map_settings.show_all)?_c('div',{staticClass:\"form-group row\"},[_c('label',{staticClass:\"col-md-12 col-form-label\",attrs:{\"for\":\"formControlRange\"}},[_vm._v(\"Time slider\\n                   \"),(_vm.map_settings.mapSelectedAge > 0)?_c('small',[_vm._v(\"(showing map as of\\n                     \"+_vm._s(_vm.map_settings.mapSelectedAge)+\" minutes ago)\")]):_c('small',[_vm._v(\"(showing live map)\")])]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-12\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.map_settings.mapSelectedAge),expression:\"map_settings.mapSelectedAge\"}],staticClass:\"form-control-range w-100\",attrs:{\"type\":\"range\",\"id\":\"formControlRange\",\"max\":_vm.mapAgeInMinutes,\"step\":\"5\",\"min\":\"0\"},domProps:{\"value\":(_vm.map_settings.mapSelectedAge)},on:{\"__r\":function($event){return _vm.$set(_vm.map_settings, \"mapSelectedAge\", $event.target.value)}}})])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"form-group row\"},[_c('label',{staticClass:\"col-md-12 col-form-label\"},[_vm._v(\"Visible markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-12\"},[_c('div',{staticClass:\"form-check\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.map_settings.show_all),expression:\"map_settings.show_all\"}],attrs:{\"type\":\"checkbox\",\"id\":\"show_all_checkbox\"},domProps:{\"checked\":Array.isArray(_vm.map_settings.show_all)?_vm._i(_vm.map_settings.show_all,null)>-1:(_vm.map_settings.show_all)},on:{\"change\":function($event){var $$a=_vm.map_settings.show_all,$$el=$event.target,$$c=$$el.checked?(true):(false);if(Array.isArray($$a)){var $$v=null,$$i=_vm._i($$a,$$v);if($$el.checked){$$i<0&&(_vm.$set(_vm.map_settings, \"show_all\", $$a.concat([$$v])))}else{$$i>-1&&(_vm.$set(_vm.map_settings, \"show_all\", $$a.slice(0,$$i).concat($$a.slice($$i+1))))}}else{_vm.$set(_vm.map_settings, \"show_all\", $$c)}}}}),_vm._v(\" \"),_c('label',{staticClass:\"form-check-label\",attrs:{\"for\":\"show_all_checkbox\"}},[_vm._v(\"\\n                       Show all markers\\n                     \")])])])])])])],1),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('h2',{staticClass:\"mt-5\"},[_vm._v(\"\\n           Map stats\\n         \")]):_vm._e(),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-6\"},[_c('h3',[_vm._v(\"Total markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"jumbotron jumbotron-fluid bg-dark rounded\"},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"display-4 text-center\"},[_vm._v(\"\\n                   \"+_vm._s(_vm.nonSpamMarkers.length)+\"\\n                 \")]),_vm._v(\" \"),_c('p',{staticClass:\"lead text-center\"},[_vm._v(\"All the markers created.\")])])])]),_vm._v(\" \"),_c('div',{staticClass:\"col-md-6\"},[_c('h3',[_vm._v(\"Active markers\")]),_vm._v(\" \"),_c('div',{staticClass:\"jumbotron jumbotron-fluid bg-dark rounded\"},[_c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"display-4 text-center\"},[_vm._v(\"\\n                   \"+_vm._s(_vm.nonSpamMarkers.length - _vm.expiredMarkers.length)+\"\\n                 \")]),_vm._v(\" \"),_c('p',{staticClass:\"lead text-center\"},[_vm._v(\"\\n                   Markers that are currently live.\\n                 \")])])])])]):_vm._e(),_vm._v(\" \"),(_vm.nonSpamMarkers && _vm.nonSpamMarkers.length > 0)?_c('map-markers-chart-component',{attrs:{\"markers\":_vm.markers}}):_vm._e()],1)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <map-component\n      v-if=\"map\"\n      :map_id=\"map.uuid\"\n      :map_token=\"map_token\"\n      style=\"height: 65vh\"\n      :users_can_create_markers=\"map.users_can_create_markers\"\n      :map_categories=\"categories\"\n      :initial_markers=\"activeMarkers\"\n      v-on:marker-create=\"handleMarkerCreate\"\n      v-on:marker-delete=\"handleMarkerDelete\"\n      :user=\"user\"\n    ></map-component>\n    <div v-else style=\"height: 65vh\" class=\"row align-items-center bg-dark\">\n      <div class=\"col text-center\">\n        <div>Cartes.io</div>\n        <p class=\"text-muted mb-0\">Contacting planet Earth...</p>\n      </div>\n    </div>\n    <div class=\"container\">\n      <div class=\"row justify-content-center mt-5\">\n        <div class=\"col-md-12\" style=\"max-width: 950px\">\n          <map-details-component\n            :map_id=\"map.uuid\"\n            :map_token=\"map_token\"\n            :map=\"map\"\n            v-on:map-update=\"handleMapUpdate\"\n          >\n            <map-markers-feed-component\n              v-if=\"hasLiveData\"\n              :markers=\"activeMarkers\"\n            ></map-markers-feed-component>\n            <div class=\"card bg-dark text-white mb-3\">\n              <div\n                class=\"card-header\"\n                data-toggle=\"collapse\"\n                data-target=\"#displayCollapse\"\n                aria-expanded=\"false\"\n                aria-controls=\"displayCollapse\"\n                style=\"cursor: pointer\"\n              >\n                <i class=\"fa fa-sliders\"></i> Map display options\n              </div>\n              <div class=\"card-body collapse\" id=\"displayCollapse\">\n                <div class=\"form-group row\" v-if=\"!map_settings.show_all\">\n                  <label class=\"col-md-12 col-form-label\" for=\"formControlRange\"\n                    >Time slider\n                    <small v-if=\"map_settings.mapSelectedAge > 0\"\n                      >(showing map as of\n                      {{ map_settings.mapSelectedAge }} minutes ago)</small\n                    >\n                    <small v-else>(showing live map)</small>\n                  </label>\n                  <div class=\"col-md-12\">\n                    <input\n                      type=\"range\"\n                      class=\"form-control-range w-100\"\n                      id=\"formControlRange\"\n                      :max=\"mapAgeInMinutes\"\n                      step=\"5\"\n                      min=\"0\"\n                      v-model=\"map_settings.mapSelectedAge\"\n                    />\n                  </div>\n                </div>\n                <div class=\"form-group row\">\n                  <label class=\"col-md-12 col-form-label\"\n                    >Visible markers</label\n                  >\n                  <div class=\"col-md-12\">\n                    <div class=\"form-check\">\n                      <input\n                        type=\"checkbox\"\n                        id=\"show_all_checkbox\"\n                        v-model=\"map_settings.show_all\"\n                      />\n                      <label class=\"form-check-label\" for=\"show_all_checkbox\">\n                        Show all markers\n                      </label>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <!--                         <api-data-transformer-component v-on:markers-updated=\"handleApiMarkers\"></api-data-transformer-component>\n -->\n          </map-details-component>\n          <h2 class=\"mt-5\" v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\">\n            Map stats\n          </h2>\n          <div class=\"row\" v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\">\n            <div class=\"col-md-6\">\n              <h3>Total markers</h3>\n              <div class=\"jumbotron jumbotron-fluid bg-dark rounded\">\n                <div class=\"container\">\n                  <div class=\"display-4 text-center\">\n                    {{ nonSpamMarkers.length }}\n                  </div>\n                  <p class=\"lead text-center\">All the markers created.</p>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-md-6\">\n              <h3>Active markers</h3>\n              <div class=\"jumbotron jumbotron-fluid bg-dark rounded\">\n                <div class=\"container\">\n                  <div class=\"display-4 text-center\">\n                    {{ nonSpamMarkers.length - expiredMarkers.length }}\n                  </div>\n                  <p class=\"lead text-center\">\n                    Markers that are currently live.\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n          <map-markers-chart-component\n            v-if=\"nonSpamMarkers && nonSpamMarkers.length > 0\"\n            :markers=\"markers\"\n          ></map-markers-chart-component>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script lang=\"ts\">\nimport axios from \"axios\";\nexport default {\n  // props: ['initial_map', 'initial_markers', 'initial_map_token', 'user'],\n\n  props: {\n    // Basic type check (`null` and `undefined` values will pass any type validation)\n    initial_map: Object,\n    // Multiple possible types\n    initial_markers: Object,\n    // Required string\n    initial_map_token: {\n      type: String,\n      required: false,\n    },\n    // Object with a default value\n    user: {\n      type: Object,\n      // Object or array defaults must be returned from\n      // a factory function\n      default: function () {\n        return {};\n      },\n    },\n  },\n\n  components: {},\n\n  data() {\n    return {\n      map: this.initial_map,\n      map_token: this.initial_map_token,\n      markers: this.initial_markers,\n      map_settings: {\n        show_all: false,\n        mapSelectedAge: 0,\n      },\n    };\n  },\n\n  created() {\n    if (!this.markers) {\n      this.getAllMarkers();\n    }\n    this.listenForNewMarkers();\n    this.listenForDeletedMarkers();\n  },\n\n  mounted() {},\n\n  computed: {\n    mapAgeInMinutes() {\n      if (!this.map) {\n        return false;\n      }\n      return Math.abs(Vue.moment().diff(this.map.created_at, \"minutes\"));\n    },\n    nonSpamMarkers() {\n      if (!this.markers) {\n        return [];\n      }\n      return this.markers.filter(function (marker) {\n        if (marker.is_spam && !localStorage[\"post_\" + marker.id]) {\n          return false;\n        }\n        return true;\n      });\n    },\n    activeMarkers() {\n      if (!this.markers) {\n        return [];\n      } else if (this.map_settings.show_all) {\n        return this.nonSpamMarkers;\n      }\n\n      let diff_date_time = Vue.moment().subtract(\n        this.map_settings.mapSelectedAge,\n        \"minutes\"\n      );\n\n      return this.nonSpamMarkers.filter(function (marker) {\n        if (\n          Vue.moment(marker.created_at).isSameOrBefore(\n            diff_date_time,\n            \"minute\"\n          ) &&\n          (marker.expires_at == null ||\n            Vue.moment(diff_date_time).isBefore(marker.expires_at))\n        ) {\n          return true;\n        }\n        return false;\n      });\n    },\n    expiredMarkers() {\n      if (!this.nonSpamMarkers) {\n        return [];\n      }\n      return this.nonSpamMarkers.filter(function (marker) {\n        if (!marker.expires_at) {\n          return false;\n        }\n        return Vue.moment().isAfter(Vue.moment(marker.expires_at));\n        //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\n      });\n    },\n    hasLiveData() {\n      if (!this.map) {\n        return false;\n      }\n      if (this.map.users_can_create_markers === \"no\") {\n        return false;\n      }\n      if (this.markers < 1) {\n        return false;\n      }\n      return true;\n    },\n    categories() {\n      if (!this.markers) {\n        return [];\n      }\n      var map1 = this.markers.map((x) => x.category);\n      return (\n        map1\n          .map((e) => e.id)\n          // store the indexes of the unique objects\n          .map((e, i, final) => final.indexOf(e) === i && i)\n          // eliminate the false indexes & return unique objects\n          .filter((e) => map1[e])\n          .map((e) => map1[e])\n      );\n    },\n  },\n\n  watch: {},\n\n  methods: {\n    groupBy(list, keyGetter) {\n      const map = new Map();\n      list.forEach((item) => {\n        const key = keyGetter(item);\n        const collection = map.get(key);\n        if (!collection) {\n          map.set(key, [item]);\n        } else {\n          collection.push(item);\n        }\n      });\n      return map;\n    },\n\n    getAllMarkers() {\n      axios\n        .get(\"/api/maps/\" + this.map.uuid + \"/markers?show_expired=true\")\n        .then((response) => (this.markers = response.data));\n    },\n\n    listenForNewMarkers() {\n      Echo.channel(\"maps.\" + this.map.uuid).listen(\"MarkerCreated\", (e) => {\n        // this.$notify(\"A new marker was just added\")\n        this.$notify({\n          type: \"success\",\n          title: '\"' + e.marker.category.name + '\" marker was just added',\n          text: e.marker.description,\n        });\n        this.handleMarkerCreate(e.marker);\n      });\n    },\n\n    listenForDeletedMarkers() {\n      Echo.channel(\"maps.\" + this.map.uuid).listen(\"MarkerDeleted\", (e) => {\n        this.handleMarkerDelete(e.marker.id);\n      });\n    },\n\n    handleMarkerCreate(marker) {\n      this.markers.push(marker);\n    },\n\n    handleMarkerDelete(id) {\n      this.$notify(\"A marker was just deleted\");\n      this.markers = this.markers.filter((e) => e.id !== id);\n    },\n\n    handleMapUpdate(map) {\n      this.$notify(\"Information about this map has been updated\");\n      this.map = map;\n    },\n\n    handleApiMarkers(markers) {\n      this.markers = markers;\n    },\n    markerInLocalStorageKey(id) {\n      if (localStorage[\"post_\" + id]) {\n        return true;\n      }\n      return false;\n    },\n  },\n};\n</script>\n<style>\n#formControlRange {\n  direction: rtl;\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=script&lang=ts&\"","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[1]!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[2]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MapContainerComponent.vue?vue&type=style&index=0&lang=css&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { render, staticRenderFns } from \"./MapContainerComponent.vue?vue&type=template&id=0ad63f1a&\"\nimport script from \"./MapContainerComponent.vue?vue&type=script&lang=ts&\"\nexport * from \"./MapContainerComponent.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./MapContainerComponent.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}