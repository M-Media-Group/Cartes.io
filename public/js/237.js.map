{"version":3,"sources":["webpack://site/./resources/js/components/PublicMapContainerComponent.vue?b5a7","webpack://site/resources/js/components/PublicMapContainerComponent.vue","webpack://site/./resources/js/components/PublicMapContainerComponent.vue?4c70","webpack://site/./resources/js/components/PublicMapContainerComponent.vue?e302","webpack://site/./resources/js/components/PublicMapContainerComponent.vue","webpack://site/./resources/js/components/PublicMapContainerComponent.vue?d40a"],"names":["___CSS_LOADER_EXPORT___","push","module","id","options","_vm","this","_h","$createElement","_c","_self","attrs","key","staticStyle","staticClass","on","$event","setMenuVisibility","_v","map","uuid","class","map_selector","setMapSelector","activeMaps","length","_l","single_map","index","setMap","_s","title","description","_e","users_can_create_markers","categories","handleMarkerCreate","handleMarkerDelete"],"mappings":"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","file":"js/237.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#formControlRange{direction:rtl}.slide-enter-active,.slide-leave-active{transition:transform .2s ease}.slide-enter,.slide-leave-to{transform:translateX(-100%);transition:all .15s ease-in 0s}\", \"\",{\"version\":3,\"sources\":[\"webpack://./resources/js/components/PublicMapContainerComponent.vue\"],\"names\":[],\"mappings\":\"AAgSA,kBACA,aACA,CACA,wCAGA,6BACA,CAEA,6BAEA,2BAAA,CACA,8BACA\",\"sourcesContent\":[\"<template>\\n    <div>\\n        <transition name=\\\"slide\\\">\\n            <div key=\\\"menu\\\" style=\\\"position: fixed; left:1.5rem;bottom:3rem;z-index: 1000;\\\" v-if=\\\"menu_hidden\\\">\\n                <div class=\\\"btn btn-primary\\\" @click=\\\"setMenuVisibility(true)\\\">Show all maps</div>\\n                <a :href=\\\"/maps/+map.uuid\\\" class=\\\"btn btn-secondary\\\">Open map page</a>\\n            </div>\\n            <div v-else key=\\\"menu_button\\\" class=\\\"p-0\\\" style=\\\"height: 100vh;position: fixed; left:0;top:0;z-index: 1001; min-width: 18rem;max-width:27rem;background-color: var(--white);\\\">\\n                <ul id=\\\"marker_feed\\\" class=\\\"list-unstyled px-0 pb-3 bg-transparent card\\\">\\n                    <li class=\\\"media p-3 card-header\\\" style=\\\"cursor: pointer;display:block;\\\">\\n                        <div class=\\\"media-body\\\" style=\\\"display:flex;align-items: center;justify-content: space-between;\\\">\\n                            <h5 class=\\\"mt-0 mb-0\\\">Maps on Cartes.io</h5>\\n                            <a href=\\\"javascript:void(0)\\\" class=\\\"btn btn-sm text-white\\\" @click=\\\"setMenuVisibility(0)\\\">X</a>\\n                        </div>\\n                        <div class=\\\"mt-3\\\" style=\\\"display:flex;align-items: center;justify-content: space-between;\\\">\\n                            <a class=\\\"btn btn-sm\\\" href=\\\"#\\\" @click=\\\"setMapSelector('user')\\\" v-bind:class=\\\"[map_selector == 'user' ? 'btn-primary' : 'btn-dark']\\\">Your maps</a>\\n                            <a class=\\\"btn btn-sm\\\" href=\\\"#\\\" @click=\\\"setMapSelector('public')\\\" v-bind:class=\\\"[map_selector == 'public' ? 'btn-primary' : 'btn-dark']\\\">Public maps</a>\\n                        </div>\\n                    </li>\\n                    <div id=\\\"marker_feed_markers\\\" class=\\\"collapse show\\\" style=\\\"max-height:83vh; overflow-y: scroll;\\\">\\n                        <template v-if=\\\"activeMaps.length > 0\\\">\\n                            <li class=\\\"media ml-3 mr-3 p-3 mb-3 card\\\" v-for=\\\"single_map, index in activeMaps\\\" :key=\\\"'map_id_'+single_map.uuid\\\" @click=\\\"setMap(index)\\\" v-bind:class=\\\"[map && single_map.uuid == map.uuid ? 'bg-white text-dark' : 'bg-secondary text-white feed-element']\\\">\\n                                <div class=\\\"media-body\\\">\\n                                    <h5 class=\\\"mt-0 mb-1\\\">{{single_map.title || \\\"Untitled map\\\"}}</h5>\\n                                    <div v-if=\\\"map && single_map.uuid == map.uuid\\\">\\n                                        <p>{{ single_map.description }}</p>\\n                                        <a :href=\\\"/maps/+map.uuid\\\" class=\\\"btn btn-primary btn-block w-100\\\">Open map page</a>\\n                                    </div>\\n                                </div>\\n                            </li>\\n                            <li class=\\\"media ml-3 mr-3 p-3 mb-3\\\">\\n                                <div class=\\\"media-body\\\">\\n                                        <button type=\\\"submit\\\" class=\\\"btn btn-primary mt-3 mb-5 w-100\\\" form=\\\"new_map_form\\\">\\n                                            Create a map\\n                                        </button>\\n                                </div>\\n                            </li>\\n                        </template>\\n                        <template v-else>\\n                            <div class=\\\"text-center text-muted p-3\\\">There's no maps to show.</div>\\n                            <li class=\\\"media ml-3 mr-3 p-3 mb-3\\\">\\n                                <div class=\\\"media-body\\\">\\n                                        <button type=\\\"submit\\\" class=\\\"btn btn-primary mt-3 mb-5 w-100\\\" form=\\\"new_map_form\\\">\\n                                            Create a map\\n                                        </button>\\n                                </div>\\n                            </li>\\n                        </template>\\n                    </div>\\n                </ul>\\n            </div>\\n        </transition>\\n        <div class=\\\"col-12 p-0\\\" @touchstart=\\\"setMenuVisibility(0)\\\" @mousedown=\\\"setMenuVisibility(0)\\\">\\n            <map-component v-if=\\\"map\\\" :map_id=\\\"map.uuid\\\" :map_token=\\\"null\\\" style=\\\"height: 100vh;\\\" :users_can_create_markers=\\\"map.users_can_create_markers\\\" :map_categories=\\\"categories\\\" :initial_markers=\\\"null\\\" v-on:marker-create=\\\"handleMarkerCreate\\\" v-on:marker-delete=\\\"handleMarkerDelete\\\"></map-component>\\n            <div v-else style=\\\"height: 65vh;\\\" class=\\\"row align-items-center bg-dark\\\">\\n                <div class=\\\"col text-center\\\">\\n                    <div>Cartes.io</div>\\n                    <p class=\\\"text-muted mb-0\\\">Contacting planet Earth...</p>\\n                </div>\\n            </div>\\n        </div>\\n\\n    </div>\\n</template>\\n<script>\\nexport default {\\n    props: [],\\n\\n    components: {},\\n\\n    data() {\\n        return {\\n            map_selector: 'public',\\n            map: null,\\n            maps: [],\\n            user_maps: [],\\n            markers: null,\\n            menu_hidden: false,\\n            map_settings: {\\n                show_all: true,\\n                mapSelectedAge: 0,\\n            },\\n        }\\n    },\\n\\n    created() {\\n        this.getAllMaps()\\n        // if (!this.map && !this.markers) {\\n        //     //this.getAllMarkers()\\n        // } else if (this.map && !this.markers) {\\n        //     this.getAllMarkers()\\n        //     this.listenForNewMarkers()\\n        //     this.listenForDeletedMarkers()\\n        // }\\n\\n    },\\n\\n    mounted() {\\n        this.getUsersMaps()\\n    },\\n\\n    computed: {\\n        mapAgeInMinutes() {\\n            if (!this.map) {\\n                return false;\\n            }\\n            return Math.abs(Vue.moment().diff(this.map.created_at, 'minutes'))\\n        },\\n        activeMarkers() {\\n            if (!this.markers) {\\n                return []\\n            } else if (this.map_settings.show_all) {\\n                return this.markers\\n            }\\n\\n            let markers = this.markers\\n            let diff_date_time = Vue.moment().subtract(this.map_settings.mapSelectedAge, 'minutes');\\n\\n            return markers.filter(function(marker) {\\n                if (Vue.moment(marker.created_at).isSameOrBefore(diff_date_time, 'minute') && (marker.expires_at == null || Vue.moment(diff_date_time).isBefore(marker.expires_at))) {\\n                    return true\\n                }\\n                return false\\n            })\\n        },\\n        expiredMarkers() {\\n            if (!this.markers) {\\n                return []\\n            }\\n            return this.markers.filter(function(marker) {\\n                if (!marker.expires_at) {\\n                    return false\\n                }\\n                return Vue.moment().isAfter(Vue.moment(marker.expires_at))\\n                //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\\n            })\\n        },\\n        hasLiveData() {\\n            if (!this.map) {\\n                return false\\n            }\\n            if (this.map.users_can_create_markers === 'no') {\\n                return false\\n            }\\n            if (this.markers < 1) {\\n                return false\\n            }\\n            return true\\n        },\\n        categories() {\\n            if (!this.markers) {\\n                return []\\n            }\\n            var map1 = this.markers.map(x => x.category);\\n            return map1.map(e => e.id)\\n                // store the indexes of the unique objects\\n                .map((e, i, final) => final.indexOf(e) === i && i)\\n                // eliminate the false indexes & return unique objects\\n                .filter((e) => map1[e]).map(e => map1[e]);\\n        },\\n        activeMaps() {\\n            if (this.map_selector == 'user') {\\n                return this.user_maps\\n            }\\n            return this.maps.filter(function(single_map) {\\n                return single_map.markers_count > 0 && single_map.title !== \\\"\\\"\\n            })\\n        }\\n    },\\n\\n    watch: {\\n\\n    },\\n\\n    methods: {\\n        groupBy(list, keyGetter) {\\n            const map = new Map();\\n            list.forEach((item) => {\\n                const key = keyGetter(item);\\n                const collection = map.get(key);\\n                if (!collection) {\\n                    map.set(key, [item]);\\n                } else {\\n                    collection.push(item);\\n                }\\n            });\\n            return map;\\n        },\\n\\n        getAllMaps() {\\n            axios\\n                .get('/api/maps')\\n                .then(response => (\\n                    this.maps = response.data.data,\\n                    this.setMap(0)\\n                ))\\n        },\\n\\n        getUsersMaps() {\\n            var ids = []\\n            Object.keys(localStorage).forEach(function(key) {\\n                if (key.includes('map_')) {\\n                    ids.push(key.replace('map_', ''))\\n                }\\n            });\\n\\n            if (ids.length > 0) {\\n                axios\\n                    .get('/api/maps', {\\n                        params: {\\n                            ids: ids,\\n                            orderBy: 'updated_at'\\n                        }\\n                    })\\n                    .then(response => {\\n                        this.user_maps = response.data.data\\n                    }\\n                    )\\n            }\\n        },\\n\\n        getAllMarkers() {\\n            axios\\n                .get('/api/maps/' + this.map.uuid + '/markers?show_expired=true')\\n                .then(response => (\\n                    this.markers = response.data\\n                ))\\n        },\\n\\n        listenForNewMarkers() {\\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerCreated', (e) => {\\n                this.handleMarkerCreate(e.marker);\\n            });\\n        },\\n\\n        listenForDeletedMarkers() {\\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerDeleted', (e) => {\\n                this.handleMarkerDelete(e.marker.id);\\n            });\\n        },\\n\\n        handleMarkerCreate(marker) {\\n            this.markers.push(marker);\\n        },\\n\\n        handleMarkerDelete(id) {\\n            this.markers = this.markers.filter((e) => e.id !== id)\\n        },\\n\\n        handleMapUpdate(map) {\\n            this.map = map\\n        },\\n\\n        handleApiMarkers(markers) {\\n            this.markers = markers\\n        },\\n\\n        getMap(map_uuid) {\\n            axios\\n                .get('/api/maps/' + map_uuid )\\n                .then(response => (\\n                    this.map = response.data\\n                ))\\n            this.getAllMarkers()\\n            this.listenForNewMarkers()\\n            this.listenForDeletedMarkers()\\n        },\\n\\n        setMap(index) {\\n            this.map = this.activeMaps[index]\\n        },\\n\\n        setMapSelector(value) {\\n            this.map_selector = value\\n        },\\n\\n        setMenuVisibility(value) {\\n            if (value) {\\n                return this.menu_hidden = false\\n            }\\n            return this.menu_hidden = true\\n        }\\n\\n    }\\n}\\n\\n</script>\\n<style>\\n#formControlRange {\\n    direction: rtl\\n}\\n.slide-enter-active,\\n.slide-leave-active\\n{\\n    transition: transform 0.2s ease;\\n}\\n\\n.slide-enter,\\n.slide-leave-to {\\n    transform: translateX(-100%);\\n    transition: all 150ms ease-in 0s;\\n}\\n</style>\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","<template>\n    <div>\n        <transition name=\"slide\">\n            <div key=\"menu\" style=\"position: fixed; left:1.5rem;bottom:3rem;z-index: 1000;\" v-if=\"menu_hidden\">\n                <div class=\"btn btn-primary\" @click=\"setMenuVisibility(true)\">Show all maps</div>\n                <a :href=\"/maps/+map.uuid\" class=\"btn btn-secondary\">Open map page</a>\n            </div>\n            <div v-else key=\"menu_button\" class=\"p-0\" style=\"height: 100vh;position: fixed; left:0;top:0;z-index: 1001; min-width: 18rem;max-width:27rem;background-color: var(--white);\">\n                <ul id=\"marker_feed\" class=\"list-unstyled px-0 pb-3 bg-transparent card\">\n                    <li class=\"media p-3 card-header\" style=\"cursor: pointer;display:block;\">\n                        <div class=\"media-body\" style=\"display:flex;align-items: center;justify-content: space-between;\">\n                            <h5 class=\"mt-0 mb-0\">Maps on Cartes.io</h5>\n                            <a href=\"javascript:void(0)\" class=\"btn btn-sm text-white\" @click=\"setMenuVisibility(0)\">X</a>\n                        </div>\n                        <div class=\"mt-3\" style=\"display:flex;align-items: center;justify-content: space-between;\">\n                            <a class=\"btn btn-sm\" href=\"#\" @click=\"setMapSelector('user')\" v-bind:class=\"[map_selector == 'user' ? 'btn-primary' : 'btn-dark']\">Your maps</a>\n                            <a class=\"btn btn-sm\" href=\"#\" @click=\"setMapSelector('public')\" v-bind:class=\"[map_selector == 'public' ? 'btn-primary' : 'btn-dark']\">Public maps</a>\n                        </div>\n                    </li>\n                    <div id=\"marker_feed_markers\" class=\"collapse show\" style=\"max-height:83vh; overflow-y: scroll;\">\n                        <template v-if=\"activeMaps.length > 0\">\n                            <li class=\"media ml-3 mr-3 p-3 mb-3 card\" v-for=\"single_map, index in activeMaps\" :key=\"'map_id_'+single_map.uuid\" @click=\"setMap(index)\" v-bind:class=\"[map && single_map.uuid == map.uuid ? 'bg-white text-dark' : 'bg-secondary text-white feed-element']\">\n                                <div class=\"media-body\">\n                                    <h5 class=\"mt-0 mb-1\">{{single_map.title || \"Untitled map\"}}</h5>\n                                    <div v-if=\"map && single_map.uuid == map.uuid\">\n                                        <p>{{ single_map.description }}</p>\n                                        <a :href=\"/maps/+map.uuid\" class=\"btn btn-primary btn-block w-100\">Open map page</a>\n                                    </div>\n                                </div>\n                            </li>\n                            <li class=\"media ml-3 mr-3 p-3 mb-3\">\n                                <div class=\"media-body\">\n                                        <button type=\"submit\" class=\"btn btn-primary mt-3 mb-5 w-100\" form=\"new_map_form\">\n                                            Create a map\n                                        </button>\n                                </div>\n                            </li>\n                        </template>\n                        <template v-else>\n                            <div class=\"text-center text-muted p-3\">There's no maps to show.</div>\n                            <li class=\"media ml-3 mr-3 p-3 mb-3\">\n                                <div class=\"media-body\">\n                                        <button type=\"submit\" class=\"btn btn-primary mt-3 mb-5 w-100\" form=\"new_map_form\">\n                                            Create a map\n                                        </button>\n                                </div>\n                            </li>\n                        </template>\n                    </div>\n                </ul>\n            </div>\n        </transition>\n        <div class=\"col-12 p-0\" @touchstart=\"setMenuVisibility(0)\" @mousedown=\"setMenuVisibility(0)\">\n            <map-component v-if=\"map\" :map_id=\"map.uuid\" :map_token=\"null\" style=\"height: 100vh;\" :users_can_create_markers=\"map.users_can_create_markers\" :map_categories=\"categories\" :initial_markers=\"null\" v-on:marker-create=\"handleMarkerCreate\" v-on:marker-delete=\"handleMarkerDelete\"></map-component>\n            <div v-else style=\"height: 65vh;\" class=\"row align-items-center bg-dark\">\n                <div class=\"col text-center\">\n                    <div>Cartes.io</div>\n                    <p class=\"text-muted mb-0\">Contacting planet Earth...</p>\n                </div>\n            </div>\n        </div>\n\n    </div>\n</template>\n<script>\nexport default {\n    props: [],\n\n    components: {},\n\n    data() {\n        return {\n            map_selector: 'public',\n            map: null,\n            maps: [],\n            user_maps: [],\n            markers: null,\n            menu_hidden: false,\n            map_settings: {\n                show_all: true,\n                mapSelectedAge: 0,\n            },\n        }\n    },\n\n    created() {\n        this.getAllMaps()\n        // if (!this.map && !this.markers) {\n        //     //this.getAllMarkers()\n        // } else if (this.map && !this.markers) {\n        //     this.getAllMarkers()\n        //     this.listenForNewMarkers()\n        //     this.listenForDeletedMarkers()\n        // }\n\n    },\n\n    mounted() {\n        this.getUsersMaps()\n    },\n\n    computed: {\n        mapAgeInMinutes() {\n            if (!this.map) {\n                return false;\n            }\n            return Math.abs(Vue.moment().diff(this.map.created_at, 'minutes'))\n        },\n        activeMarkers() {\n            if (!this.markers) {\n                return []\n            } else if (this.map_settings.show_all) {\n                return this.markers\n            }\n\n            let markers = this.markers\n            let diff_date_time = Vue.moment().subtract(this.map_settings.mapSelectedAge, 'minutes');\n\n            return markers.filter(function(marker) {\n                if (Vue.moment(marker.created_at).isSameOrBefore(diff_date_time, 'minute') && (marker.expires_at == null || Vue.moment(diff_date_time).isBefore(marker.expires_at))) {\n                    return true\n                }\n                return false\n            })\n        },\n        expiredMarkers() {\n            if (!this.markers) {\n                return []\n            }\n            return this.markers.filter(function(marker) {\n                if (!marker.expires_at) {\n                    return false\n                }\n                return Vue.moment().isAfter(Vue.moment(marker.expires_at))\n                //return new Date() > new Date(Date.parse(marker.expires_at.replace(/-/g, '/')))\n            })\n        },\n        hasLiveData() {\n            if (!this.map) {\n                return false\n            }\n            if (this.map.users_can_create_markers === 'no') {\n                return false\n            }\n            if (this.markers < 1) {\n                return false\n            }\n            return true\n        },\n        categories() {\n            if (!this.markers) {\n                return []\n            }\n            var map1 = this.markers.map(x => x.category);\n            return map1.map(e => e.id)\n                // store the indexes of the unique objects\n                .map((e, i, final) => final.indexOf(e) === i && i)\n                // eliminate the false indexes & return unique objects\n                .filter((e) => map1[e]).map(e => map1[e]);\n        },\n        activeMaps() {\n            if (this.map_selector == 'user') {\n                return this.user_maps\n            }\n            return this.maps.filter(function(single_map) {\n                return single_map.markers_count > 0 && single_map.title !== \"\"\n            })\n        }\n    },\n\n    watch: {\n\n    },\n\n    methods: {\n        groupBy(list, keyGetter) {\n            const map = new Map();\n            list.forEach((item) => {\n                const key = keyGetter(item);\n                const collection = map.get(key);\n                if (!collection) {\n                    map.set(key, [item]);\n                } else {\n                    collection.push(item);\n                }\n            });\n            return map;\n        },\n\n        getAllMaps() {\n            axios\n                .get('/api/maps')\n                .then(response => (\n                    this.maps = response.data.data,\n                    this.setMap(0)\n                ))\n        },\n\n        getUsersMaps() {\n            var ids = []\n            Object.keys(localStorage).forEach(function(key) {\n                if (key.includes('map_')) {\n                    ids.push(key.replace('map_', ''))\n                }\n            });\n\n            if (ids.length > 0) {\n                axios\n                    .get('/api/maps', {\n                        params: {\n                            ids: ids,\n                            orderBy: 'updated_at'\n                        }\n                    })\n                    .then(response => {\n                        this.user_maps = response.data.data\n                    }\n                    )\n            }\n        },\n\n        getAllMarkers() {\n            axios\n                .get('/api/maps/' + this.map.uuid + '/markers?show_expired=true')\n                .then(response => (\n                    this.markers = response.data\n                ))\n        },\n\n        listenForNewMarkers() {\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerCreated', (e) => {\n                this.handleMarkerCreate(e.marker);\n            });\n        },\n\n        listenForDeletedMarkers() {\n            Echo.channel('maps.' + this.map.uuid).listen('MarkerDeleted', (e) => {\n                this.handleMarkerDelete(e.marker.id);\n            });\n        },\n\n        handleMarkerCreate(marker) {\n            this.markers.push(marker);\n        },\n\n        handleMarkerDelete(id) {\n            this.markers = this.markers.filter((e) => e.id !== id)\n        },\n\n        handleMapUpdate(map) {\n            this.map = map\n        },\n\n        handleApiMarkers(markers) {\n            this.markers = markers\n        },\n\n        getMap(map_uuid) {\n            axios\n                .get('/api/maps/' + map_uuid )\n                .then(response => (\n                    this.map = response.data\n                ))\n            this.getAllMarkers()\n            this.listenForNewMarkers()\n            this.listenForDeletedMarkers()\n        },\n\n        setMap(index) {\n            this.map = this.activeMaps[index]\n        },\n\n        setMapSelector(value) {\n            this.map_selector = value\n        },\n\n        setMenuVisibility(value) {\n            if (value) {\n                return this.menu_hidden = false\n            }\n            return this.menu_hidden = true\n        }\n\n    }\n}\n\n</script>\n<style>\n#formControlRange {\n    direction: rtl\n}\n.slide-enter-active,\n.slide-leave-active\n{\n    transition: transform 0.2s ease;\n}\n\n.slide-enter,\n.slide-leave-to {\n    transform: translateX(-100%);\n    transition: all 150ms ease-in 0s;\n}\n</style>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMapContainerComponent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-5[0].rules[0].use[0]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMapContainerComponent.vue?vue&type=script&lang=js&\"","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[1]!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-9[0].rules[0].use[2]!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PublicMapContainerComponent.vue?vue&type=style&index=0&lang=css&\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import { render, staticRenderFns } from \"./PublicMapContainerComponent.vue?vue&type=template&id=7a7f2084&\"\nimport script from \"./PublicMapContainerComponent.vue?vue&type=script&lang=js&\"\nexport * from \"./PublicMapContainerComponent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PublicMapContainerComponent.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('transition',{attrs:{\"name\":\"slide\"}},[(_vm.menu_hidden)?_c('div',{key:\"menu\",staticStyle:{\"position\":\"fixed\",\"left\":\"1.5rem\",\"bottom\":\"3rem\",\"z-index\":\"1000\"}},[_c('div',{staticClass:\"btn btn-primary\",on:{\"click\":function($event){return _vm.setMenuVisibility(true)}}},[_vm._v(\"Show all maps\")]),_vm._v(\" \"),_c('a',{staticClass:\"btn btn-secondary\",attrs:{\"href\":/maps/+_vm.map.uuid}},[_vm._v(\"Open map page\")])]):_c('div',{key:\"menu_button\",staticClass:\"p-0\",staticStyle:{\"height\":\"100vh\",\"position\":\"fixed\",\"left\":\"0\",\"top\":\"0\",\"z-index\":\"1001\",\"min-width\":\"18rem\",\"max-width\":\"27rem\",\"background-color\":\"var(--white)\"}},[_c('ul',{staticClass:\"list-unstyled px-0 pb-3 bg-transparent card\",attrs:{\"id\":\"marker_feed\"}},[_c('li',{staticClass:\"media p-3 card-header\",staticStyle:{\"cursor\":\"pointer\",\"display\":\"block\"}},[_c('div',{staticClass:\"media-body\",staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"justify-content\":\"space-between\"}},[_c('h5',{staticClass:\"mt-0 mb-0\"},[_vm._v(\"Maps on Cartes.io\")]),_vm._v(\" \"),_c('a',{staticClass:\"btn btn-sm text-white\",attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":function($event){return _vm.setMenuVisibility(0)}}},[_vm._v(\"X\")])]),_vm._v(\" \"),_c('div',{staticClass:\"mt-3\",staticStyle:{\"display\":\"flex\",\"align-items\":\"center\",\"justify-content\":\"space-between\"}},[_c('a',{staticClass:\"btn btn-sm\",class:[_vm.map_selector == 'user' ? 'btn-primary' : 'btn-dark'],attrs:{\"href\":\"#\"},on:{\"click\":function($event){return _vm.setMapSelector('user')}}},[_vm._v(\"Your maps\")]),_vm._v(\" \"),_c('a',{staticClass:\"btn btn-sm\",class:[_vm.map_selector == 'public' ? 'btn-primary' : 'btn-dark'],attrs:{\"href\":\"#\"},on:{\"click\":function($event){return _vm.setMapSelector('public')}}},[_vm._v(\"Public maps\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"collapse show\",staticStyle:{\"max-height\":\"83vh\",\"overflow-y\":\"scroll\"},attrs:{\"id\":\"marker_feed_markers\"}},[(_vm.activeMaps.length > 0)?[_vm._l((_vm.activeMaps),function(single_map,index){return _c('li',{key:'map_id_'+single_map.uuid,staticClass:\"media ml-3 mr-3 p-3 mb-3 card\",class:[_vm.map && single_map.uuid == _vm.map.uuid ? 'bg-white text-dark' : 'bg-secondary text-white feed-element'],on:{\"click\":function($event){return _vm.setMap(index)}}},[_c('div',{staticClass:\"media-body\"},[_c('h5',{staticClass:\"mt-0 mb-1\"},[_vm._v(_vm._s(single_map.title || \"Untitled map\"))]),_vm._v(\" \"),(_vm.map && single_map.uuid == _vm.map.uuid)?_c('div',[_c('p',[_vm._v(_vm._s(single_map.description))]),_vm._v(\" \"),_c('a',{staticClass:\"btn btn-primary btn-block w-100\",attrs:{\"href\":/maps/+_vm.map.uuid}},[_vm._v(\"Open map page\")])]):_vm._e()])])}),_vm._v(\" \"),_c('li',{staticClass:\"media ml-3 mr-3 p-3 mb-3\"},[_c('div',{staticClass:\"media-body\"},[_c('button',{staticClass:\"btn btn-primary mt-3 mb-5 w-100\",attrs:{\"type\":\"submit\",\"form\":\"new_map_form\"}},[_vm._v(\"\\n                                        Create a map\\n                                    \")])])])]:[_c('div',{staticClass:\"text-center text-muted p-3\"},[_vm._v(\"There's no maps to show.\")]),_vm._v(\" \"),_c('li',{staticClass:\"media ml-3 mr-3 p-3 mb-3\"},[_c('div',{staticClass:\"media-body\"},[_c('button',{staticClass:\"btn btn-primary mt-3 mb-5 w-100\",attrs:{\"type\":\"submit\",\"form\":\"new_map_form\"}},[_vm._v(\"\\n                                        Create a map\\n                                    \")])])])]],2)])])]),_vm._v(\" \"),_c('div',{staticClass:\"col-12 p-0\",on:{\"touchstart\":function($event){return _vm.setMenuVisibility(0)},\"mousedown\":function($event){return _vm.setMenuVisibility(0)}}},[(_vm.map)?_c('map-component',{staticStyle:{\"height\":\"100vh\"},attrs:{\"map_id\":_vm.map.uuid,\"map_token\":null,\"users_can_create_markers\":_vm.map.users_can_create_markers,\"map_categories\":_vm.categories,\"initial_markers\":null},on:{\"marker-create\":_vm.handleMarkerCreate,\"marker-delete\":_vm.handleMarkerDelete}}):_c('div',{staticClass:\"row align-items-center bg-dark\",staticStyle:{\"height\":\"65vh\"}},[_c('div',{staticClass:\"col text-center\"},[_c('div',[_vm._v(\"Cartes.io\")]),_vm._v(\" \"),_c('p',{staticClass:\"text-muted mb-0\"},[_vm._v(\"Contacting planet Earth...\")])])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }"],"sourceRoot":""}